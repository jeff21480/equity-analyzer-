<html lang="cs">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Equity Analyz√©r ‚Äì DCF & Watchlist</title>
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Equity Analyzer</title>

  <style>
    :root{
      --bg0:#050513;
      --bg1:#0a0a1f;
      --card:#0f1030;
      --card2:#131440;
      --bg:#0b0e1f;
      --bg2:#0f1330;
      --card:#121845;
      --card2:#161f55;
      --stroke:rgba(255,255,255,.10);
      --stroke2:rgba(255,255,255,.16);

      --txt:rgba(255,255,255,.92);
      --muted:rgba(255,255,255,.72);
      --faint:rgba(255,255,255,.55);
      --text:#eef0ff;
      --muted:rgba(238,240,255,.72);

      --purple:#8b5cf6;
      --purple2:#a78bfa;
      --blue:#60a5fa;
      --blue:#3b82f6;
      --cyan:#22d3ee;

      --bear:#60a5fa;   /* modr√° */
      --base:#a78bfa;   /* fialov√° */
      --bull:#22d3ee;   /* cyan */
      --bull:#34d399;   /* zelen√° */

      --good:#34d399;
      --bad:#fb7185;
      --danger:#fb7185;
      --ok:#34d399;

      --shadow: 0 18px 55px rgba(0,0,0,.45);
      --r16:16px;
      --r20:20px;
      --r24:24px;
      --radius:18px;
      --radius2:14px;
    }

    *{ box-sizing:border-box; }
    html, body{ height:100%; }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      color:var(--txt);
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial, "Apple Color Emoji","Segoe UI Emoji";
      background:
        radial-gradient(1200px 700px at 15% 10%, rgba(139,92,246,.28), transparent 60%),
        radial-gradient(900px 650px at 85% 20%, rgba(96,165,250,.22), transparent 60%),
        radial-gradient(900px 650px at 50% 95%, rgba(34,211,238,.16), transparent 60%),
        linear-gradient(180deg, var(--bg0), var(--bg1));
      overflow-x:hidden;
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial;
      background: radial-gradient(1200px 600px at 20% 10%, rgba(139,92,246,.25), transparent 60%),
                  radial-gradient(900px 500px at 80% 20%, rgba(59,130,246,.20), transparent 55%),
                  linear-gradient(180deg, var(--bg), var(--bg2));
      color:var(--text);
    }

    .wrap{
      max-width:1080px;
      margin:0 auto;
      padding:18px 14px 40px;
    .app{
      max-width: 1120px;
      margin: 0 auto;
      padding: 18px 14px 40px;
    }

    .topbar{
    header{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:12px;
      padding:14px 16px;
      background: linear-gradient(180deg, rgba(15,16,48,.75), rgba(10,10,31,.55));
      margin-bottom:14px;
      padding:14px 14px;
      border:1px solid var(--stroke);
      border-radius: var(--r24);
      box-shadow: var(--shadow);
      background: rgba(18,24,69,.55);
      backdrop-filter: blur(10px);
      border-radius: var(--radius);
    }

    .brand{
      display:flex; align-items:center; gap:12px;
      min-width: 0;
    }
    .logo{
      width:44px; height:44px; border-radius:14px;
      background: radial-gradient(circle at 30% 30%, rgba(167,139,250,.95), rgba(96,165,250,.65) 55%, rgba(34,211,238,.35));
      border:1px solid rgba(255,255,255,.16);
      box-shadow: 0 14px 30px rgba(0,0,0,.35);
      flex: 0 0 auto;
      display:flex;
      flex-direction:column;
      gap:2px;
      min-width: 180px;
    }
    .titleBox{ min-width:0; }
    .h1{
      margin:0;
    .brand .title{
      font-weight:800;
      letter-spacing:.2px;
      font-size:18px;
      letter-spacing:.3px;
      line-height:1.15;
      white-space:nowrap;
      overflow:hidden;
      text-overflow:ellipsis;
      line-height:1.1;
      background: linear-gradient(90deg, var(--purple2), var(--blue), var(--cyan));
      -webkit-background-clip:text;
      -webkit-text-fill-color: transparent;
    }
    .sub{
      margin:2px 0 0;
      font-size:13px;
    .brand .sub{
      font-size:12px;
      color:var(--muted);
      white-space:nowrap;
      overflow:hidden;
      text-overflow:ellipsis;
    }

    .pill{
      display:inline-flex;
    .top-controls{
      display:flex;
      align-items:center;
      gap:8px;
      padding:10px 12px;
      border-radius:999px;
      justify-content:flex-end;
      gap:10px;
      flex-wrap:wrap;
    }

    .seg{
      display:flex;
      border:1px solid var(--stroke);
      background: rgba(15,16,48,.55);
      background: rgba(255,255,255,.04);
      border-radius: 999px;
      padding:4px;
      gap:4px;
    }
    .seg button{
      appearance:none;
      border:0;
      cursor:pointer;
      padding:8px 10px;
      border-radius: 999px;
      font-weight:700;
      font-size:12px;
      color:var(--muted);
      font-size:13px;
      user-select:none;
      flex: 0 0 auto;
      background: transparent;
    }

    .grid{
      margin-top:16px;
      display:grid;
      grid-template-columns: repeat(12, 1fr);
      gap:14px;
    .seg button.active{
      color: var(--text);
      background: linear-gradient(90deg, rgba(167,139,250,.35), rgba(59,130,246,.25));
    }

    .card{
      grid-column: span 12;
      border-radius: var(--r24);
      border: 1px solid var(--stroke);
      background: linear-gradient(180deg, rgba(19,20,64,.82), rgba(15,16,48,.62));
      box-shadow: var(--shadow);
      overflow:hidden;
      position:relative;
    .drawers{
      display:grid;
      grid-template-columns: repeat(3, minmax(0,1fr));
      gap:12px;
      margin-top:12px;
    }

    .card::before{
      content:"";
      position:absolute; inset:-1px;
      background:
        radial-gradient(700px 240px at 15% 10%, rgba(167,139,250,.22), transparent 60%),
        radial-gradient(600px 240px at 85% 20%, rgba(96,165,250,.18), transparent 60%);
      pointer-events:none;
    @media (max-width: 900px){
      .drawers{grid-template-columns: 1fr;}
      .brand{min-width:auto}
    }

    .cardBtn{
      width:100%;
      padding:18px 16px;
    .drawer{
      border:1px solid var(--stroke);
      border-radius: var(--radius);
      padding:14px;
      background: linear-gradient(180deg, rgba(18,24,69,.75), rgba(15,19,48,.65));
      box-shadow: 0 14px 40px rgba(0,0,0,.35);
      cursor:pointer;
      transition: transform .15s ease, border-color .15s ease, background .15s ease;
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:12px;
      background: transparent;
      border:0;
      color: var(--txt);
      cursor:pointer;
      position:relative;
      z-index:1;
      min-height: 92px;
    }

    .cardLeft{
      display:flex;
      align-items:center;
      gap:12px;
      min-width:0;
    .drawer:hover{
      transform: translateY(-2px);
      border-color: rgba(167,139,250,.35);
      background: linear-gradient(180deg, rgba(22,31,85,.75), rgba(15,19,48,.65));
    }

    .icon{
      width:44px; height:44px;
      border-radius: 16px;
      display:grid; place-items:center;
      border:1px solid rgba(255,255,255,.14);
      background: rgba(255,255,255,.06);
      flex: 0 0 auto;
    .drawer .left{
      display:flex;
      flex-direction:column;
      gap:4px;
    }
    .icon.dcf{ background: rgba(167,139,250,.14); }
    .icon.wl{  background: rgba(96,165,250,.14); }
    .icon.about{ background: rgba(34,211,238,.12); }

    .cardText{ min-width:0; }
    .cardTitle{
      margin:0;
    .drawer .name{
      font-weight:800;
      font-size:16px;
      letter-spacing:.2px;
    }
    .cardDesc{
      margin:4px 0 0;
      font-size:13px;
    .drawer .desc{
      font-size:12px;
      color:var(--muted);
      line-height:1.35;
    }

    .chev{
      width:36px; height:36px;
      border-radius: 14px;
    .pill{
      padding:8px 10px;
      border-radius:999px;
      border:1px solid var(--stroke);
      display:grid;
      place-items:center;
      color:var(--muted);
      background: rgba(255,255,255,.03);
      flex: 0 0 auto;
    }/* screens (m√≠stnosti) */
      background: rgba(255,255,255,.04);
      font-size:12px;
      font-weight:800;
      color:var(--text);
      white-space:nowrap;
    }

    .screen{
      display:none;
      margin-top:14px;
      border-radius: var(--r24);
      border:1px solid var(--stroke);
      background: linear-gradient(180deg, rgba(19,20,64,.86), rgba(10,10,31,.70));
      box-shadow: var(--shadow);
      border-radius: var(--radius);
      background: linear-gradient(180deg, rgba(18,24,69,.75), rgba(15,19,48,.70));
      box-shadow: 0 14px 40px rgba(0,0,0,.35);
      overflow:hidden;
    }
    .screen.active{ display:block; }
    .screen.active{display:block}

    .screenTop{
    .screen-head{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:12px;
      padding:16px 16px;
      padding:14px 14px;
      border-bottom:1px solid var(--stroke);
      background: rgba(10,10,31,.35);
      background: rgba(255,255,255,.03);
    }
    .screenTitle{
    .screen-head h2{
      margin:0;
      font-size:18px;
      letter-spacing:.2px;
      font-size:16px;
      font-weight:900;
    }
    .backBtn{
      display:inline-flex;
      align-items:center;
      gap:8px;
      padding:10px 12px;
      border-radius: 14px;
      border:1px solid var(--stroke2);
      border:1px solid var(--stroke);
      background: rgba(255,255,255,.05);
      color: var(--txt);
      color: var(--text);
      padding:8px 10px;
      border-radius: 12px;
      font-weight:800;
      cursor:pointer;
      font-weight:700;
    }
    .backBtn:hover{ background: rgba(255,255,255,.08); }
    .backBtn:hover{border-color: rgba(167,139,250,.35)}

    .content{
      padding:16px;
    .screen-body{
      padding: 14px;
    }

    .row{
    .grid{
      display:grid;
      grid-template-columns: repeat(12, 1fr);
      grid-template-columns: 1.2fr .8fr;
      gap:12px;
      align-items:start;
    }
    .col6{ grid-column: span 12; }
    .col12{ grid-column: span 12; }

    @media (min-width: 860px){
      .card{ grid-column: span 6; }
      .col6{ grid-column: span 6; }
    @media (max-width: 900px){
      .grid{grid-template-columns: 1fr;}
    }

    .panel{
    .card{
      border:1px solid var(--stroke);
      background: rgba(255,255,255,.04);
      border-radius: var(--r20);
      border-radius: var(--radius);
      background: rgba(255,255,255,.03);
      padding:14px;
    }

    .panel h3{
      margin:0 0 10px;
    .card h3{
      margin:0 0 10px 0;
      font-size:14px;
      color:var(--muted);
      letter-spacing:.2px;
      text-transform:uppercase;
      font-weight:900;
    }

    label{
      display:block;
      font-size:12px;
      color:var(--muted);
      margin: 0 0 6px;
      letter-spacing:.2px;
    .row{
      display:grid;
      grid-template-columns: 1fr 160px;
      gap:10px;
      align-items:center;
      margin-bottom:10px;
    }
    @media (max-width: 520px){
      .row{grid-template-columns: 1fr;}
    }

    .field{
    label{
      font-size:12px;
      font-weight:800;
      color: var(--text);
      display:flex;
      align-items:center;
      gap:8px;
    }

    .hintBtn{
      width:18px;height:18px;
      border-radius:999px;
      border:1px solid var(--stroke);
      background: rgba(255,255,255,.05);
      color:var(--text);
      font-weight:900;
      display:inline-flex;
      align-items:center;
      justify-content:center;
      cursor:pointer;
      flex: 0 0 auto;
    }

    input, select{
      width:100%;
      padding:11px 12px;
      border-radius: 14px;
      border:1px solid var(--stroke2);
      background: rgba(8,8,25,.55);
      color: var(--txt);
      padding:10px 10px;
      border-radius: 12px;
      border:1px solid rgba(255,255,255,.10);
      background: rgba(0,0,0,.20);
      color: var(--text);
      font-weight:800;
      outline:none;
    }
    input::placeholder{ color: rgba(255,255,255,.35); }
    input:focus, select:focus{
      border-color: rgba(167,139,250,.45);
      box-shadow: 0 0 0 3px rgba(167,139,250,.12);
    }

    .helpBtn{
      width:36px; height:36px;
      border-radius: 14px;
      border:1px solid var(--stroke2);
      background: rgba(255,255,255,.05);
      color: var(--txt);
    .btn{
      border:0;
      cursor:pointer;
      flex: 0 0 auto;
      padding:10px 12px;
      border-radius: 14px;
      font-weight:900;
      color:#061022;
      background: linear-gradient(90deg, var(--purple2), var(--blue));
    }

    .helpBox{
      margin-top:8px;
      display:none;
    .btn:hover{filter: brightness(1.05)}
    .btn.secondary{
      background: rgba(255,255,255,.07);
      color: var(--text);
      border:1px solid var(--stroke);
      background: rgba(255,255,255,.04);
      border-radius: 14px;
      padding:10px 12px;
    }
    .btn.danger{
      background: rgba(251,113,133,.18);
      color: #ffdbe3;
      border:1px solid rgba(251,113,133,.35);
    }

    .note{
      font-size:12px;
      color: var(--muted);
      font-size:13px;
      margin-top:8px;
      line-height:1.45;
    }
    .helpBox.open{ display:block; }

    .btnRow{
      display:flex;
    .results{
      display:grid;
      grid-template-columns: repeat(3, minmax(0,1fr));
      gap:10px;
      flex-wrap:wrap;
      margin-top:12px;
      margin-top:10px;
    }
    .btn{
      border:1px solid var(--stroke2);
      background: rgba(255,255,255,.06);
      color: var(--txt);
      padding:11px 14px;
      border-radius: 14px;
      cursor:pointer;
      font-weight:800;
      letter-spacing:.2px;
    @media (max-width: 900px){
      .results{grid-template-columns: 1fr;}
    }
    .btn:hover{ background: rgba(255,255,255,.10); }

    .btn.primary{
      background: linear-gradient(135deg, rgba(167,139,250,.95), rgba(96,165,250,.85));
      border-color: rgba(255,255,255,.18);
      color:#0a0a1f;
    .rbox{
      border:1px solid var(--stroke);
      border-radius: var(--radius2);
      background: rgba(255,255,255,.03);
      padding:12px;
    }

    .tagRow{
    .rbox .tag{
      font-size:12px;
      font-weight:1000;
      letter-spacing:.2px;
      margin-bottom:8px;
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:10px;
      flex-wrap:wrap;
      margin-top:10px;
    }
    .tag{
      padding:8px 10px;
      border-radius: 999px;
    .tag .chip{
      padding:5px 9px;
      border-radius:999px;
      border:1px solid var(--stroke);
      background: rgba(255,255,255,.04);
      color: var(--muted);
      font-weight:900;
      font-size:11px;
      color: var(--text);
    }
    .rbox .price{
      font-size:26px;
      font-weight:1000;
      letter-spacing:-.3px;
    }
    .rbox .subline{
      margin-top:6px;
      color:var(--muted);
      font-size:12px;
      line-height:1.35;
    }

    .resultBox{
      border-radius: var(--r20);
    .bear{border-color: rgba(96,165,250,.35)}
    .base{border-color: rgba(167,139,250,.40)}
    .bull{border-color: rgba(52,211,153,.35)}

    .bear .tag{color: var(--bear)}
    .base .tag{color: var(--base)}
    .bull .tag{color: var(--bull)}

    .modal{
      position:fixed;
      inset:0;
      display:none;
      align-items:flex-end;
      justify-content:center;
      background: rgba(0,0,0,.55);
      padding: 18px 12px;
      z-index: 99;
    }
    .modal.open{display:flex}
    .modalCard{
      width:min(820px, 100%);
      border-radius: var(--radius);
      border:1px solid var(--stroke);
      background: rgba(255,255,255,.05);
      padding:14px;
      margin-top:12px;
      background: linear-gradient(180deg, rgba(18,24,69,.95), rgba(15,19,48,.95));
      box-shadow: 0 18px 70px rgba(0,0,0,.55);
      overflow:hidden;
    }

    .resultGrid{
      display:grid;
      grid-template-columns: repeat(12, 1fr);
    .modalHead{
      padding:12px 14px;
      border-bottom:1px solid var(--stroke);
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:10px;
    }
    .metric{
      grid-column: span 12;
      border-radius: 16px;
    .modalHead b{font-size:13px}
    .closeX{
      border:1px solid var(--stroke);
      background: rgba(10,10,31,.35);
      padding:12px;
    }
    @media (min-width: 860px){
      .metric{ grid-column: span 4; }
    }

    .metric .k{
      font-size:12px;
      color:var(--muted);
      margin:0 0 6px;
      letter-spacing:.2px;
    }
    .metric .v{
      margin:0;
      font-size:20px;
      background: rgba(255,255,255,.06);
      color:var(--text);
      border-radius: 12px;
      padding:8px 10px;
      cursor:pointer;
      font-weight:900;
      letter-spacing:.2px;
    }
    .metric.bear{ border-color: rgba(96,165,250,.35); }
    .metric.base{ border-color: rgba(167,139,250,.40); }
    .metric.bull{ border-color: rgba(34,211,238,.35); }

    .delta{
      margin-top:6px;
    .modalBody{
      padding:14px;
      color: var(--muted);
      font-size:13px;
      font-weight:800;
      line-height:1.55;
    }
    .delta.good{ color: var(--good); }
    .delta.bad{ color: var(--bad); }

    table{
      width:100%;
      border-collapse:separate;
      border-spacing:0;
      border-collapse: collapse;
      overflow:hidden;
      border-radius: var(--r20);
      border-radius: var(--radius);
      border:1px solid var(--stroke);
      background: rgba(255,255,255,.04);
      background: rgba(255,255,255,.02);
    }
    th, td{
      padding:12px 10px;
      border-bottom:1px solid var(--stroke);
      font-size:13px;
      color: var(--txt);
    th,td{
      padding:10px 10px;
      border-bottom:1px solid rgba(255,255,255,.06);
      font-size:12px;
      text-align:left;
      vertical-align:top;
      white-space:nowrap;
    }
    th{
      color: var(--muted);
      font-weight:800;
      background: rgba(10,10,31,.35);
    }
    tr:last-child td{ border-bottom:0; }

    .miniBtn{
      padding:8px 10px;
      border-radius: 12px;
      border:1px solid var(--stroke2);
      background: rgba(255,255,255,.06);
      color: var(--txt);
      cursor:pointer;
      font-weight:900;
      color: var(--text);
      vertical-align: top;
    }
    th{color: var(--muted); font-weight:900}
    tr:last-child td{border-bottom:0}

    .note{
    .rowBtns{
      display:flex;
      gap:10px;
      flex-wrap:wrap;
      margin-top:10px;
      color: var(--muted);
      font-size:13px;
      line-height:1.45;
    }
  </style>
</head><body>
  <div class="wrap">
</head>

    <div class="topbar">
<body>
  <div class="app">

    <header>
      <div class="brand">
        <div class="logo"></div>
        <div class="titleBox">
          <p class="h1">Equity Analyz√©r</p>
          <p class="sub">DCF v√Ωpoƒçet (3 sc√©n√°≈ôe) + Watchlist (LocalStorage)</p>
        <div class="title">Equity Analyzer</div>
        <div class="sub" id="topSubtitle">DCF v√Ωpoƒçet ‚Ä¢ Watchlist ‚Ä¢ Popis aplikace</div>
      </div>

      <div class="top-controls">
        <div class="seg" aria-label="language">
          <button id="langCS" class="active" type="button">CZ</button>
          <button id="langEN" type="button">EN</button>
        </div>
      </div>
      <div class="pill">Stabiln√≠ verze ‚Ä¢ 3 ≈°upl√≠ky</div>
    </div>
    </header>

    <!-- HOME: 3 ≈°upl√≠ky -->
    <div id="home" class="grid">
      <div class="card">
        <button class="cardBtn" data-open="dcf">
          <div class="cardLeft">
            <div class="icon dcf">üìà</div>
            <div class="cardText">
              <p class="cardTitle">DCF model</p>
              <p class="cardDesc">Rychl√Ω v√Ωpoƒçet f√©rov√© ceny akcie (BEAR/BASE/BULL) + ulo≈æen√≠ do Watchlistu.</p>
            </div>
          </div>
          <div class="chev">‚Ä∫</div>
        </button>
    <div class="drawers" id="drawers">
      <div class="drawer" data-screen="dcf">
        <div class="left">
          <div class="name" id="d1Title">DCF Model</div>
          <div class="desc" id="d1Desc">V√Ωpoƒçet f√©rov√© hodnoty a 3 sc√©n√°≈ôe</div>
        </div>
        <div class="pill" id="d1Pill">Open</div>
      </div>

      <div class="card">
        <button class="cardBtn" data-open="watchlist">
          <div class="cardLeft">
            <div class="icon wl">üßæ</div>
            <div class="cardText">
              <p class="cardTitle">Watchlist</p>
              <p class="cardDesc">Ulo≈æen√© v√Ωpoƒçty. Ka≈æd√Ω ≈ô√°dek lze odstranit zvl√°≈°≈•.</p>
            </div>
          </div>
          <div class="chev">‚Ä∫</div>
        </button>
      <div class="drawer" data-screen="watch">
        <div class="left">
          <div class="name" id="d2Title">Watchlist</div>
          <div class="desc" id="d2Desc">Ulo≈æen√© v√Ωpoƒçty + maz√°n√≠ polo≈æek</div>
        </div>
        <div class="pill" id="d2Pill">Open</div>
      </div>

      <div class="card">
        <button class="cardBtn" data-open="about">
          <div class="cardLeft">
            <div class="icon about">üí°</div>
            <div class="cardText">
              <p class="cardTitle">O aplikaci</p>
              <p class="cardDesc">Pro koho je, jak funguje a co znamenaj√≠ vstupy v DCF.</p>
            </div>
          </div>
          <div class="chev">‚Ä∫</div>
        </button>
      <div class="drawer" data-screen="about">
        <div class="left">
          <div class="name" id="d3Title">O aplikaci</div>
          <div class="desc" id="d3Desc">Pro koho je a jak funguje</div>
        </div>
        <div class="pill" id="d3Pill">Open</div>
      </div>
    </div>

    <!-- SCREEN: DCF -->
    <section id="screen-dcf" class="screen" aria-hidden="true">
      <div class="screenTop">
        <h2 class="screenTitle">DCF model ‚Äì f√©rov√° cena (3 sc√©n√°≈ôe)</h2>
        <button class="backBtn" data-back>‚Üê Zpƒõt</button>
    <!-- SCREENS -->
    <section class="screen" id="screen-dcf" aria-hidden="true">
      <div class="screen-head">
        <h2 id="s1Title">DCF Model</h2>
        <button class="backBtn" type="button" data-back="1" id="back1">Zpƒõt</button>
      </div>
      <div class="screen-body"><div class="grid">
          <div class="card">
            <h3 id="dcfInputTitle">Vstupy</h3>

            <div class="row">
              <label>
                <span id="lblTicker">Ticker</span>
                <button class="hintBtn" type="button" data-hint="ticker">i</button>
              </label>
              <input id="inpTicker" placeholder="nap≈ô. AAPL" inputmode="text" />
            </div>

      <div class="content">
        <div class="row">
          <div class="col6">
            <div class="panel">
              <h3>Vstupy</h3>
            <div class="row">
              <label>
                <span id="lblPrice">Aktu√°ln√≠ cena</span>
                <button class="hintBtn" type="button" data-hint="price">i</button>
              </label>
              <input id="inpPrice" placeholder="nap≈ô. 190.5" inputmode="decimal" />
            </div>

            <div class="row">
              <label>
                <span id="lblCurrency">Mƒõna</span>
                <button class="hintBtn" type="button" data-hint="currency">i</button>
              </label>
              <select id="inpCurrency">
                <option value="USD">USD ($)</option>
                <option value="EUR">EUR (‚Ç¨)</option>
              </select>
            </div>

            <div class="row">
              <label>
                <span id="lblFCF">Free Cash Flow (TTM)</span>
                <button class="hintBtn" type="button" data-hint="fcf">i</button>
              </label>
              <input id="inpFCF" placeholder="nap≈ô. 110000000000" inputmode="decimal" />
            </div>

            <div class="row">
              <label>
                <span id="lblShares">Poƒçet akci√≠ (diluted)</span>
                <button class="hintBtn" type="button" data-hint="shares">i</button>
              </label>
              <input id="inpShares" placeholder="nap≈ô. 15500000000" inputmode="decimal" />
            </div>

            <div class="row">
              <label>
                <span id="lblDisc">Diskontn√≠ sazba</span>
                <button class="hintBtn" type="button" data-hint="disc">i</button>
              </label>
              <input id="inpDisc" placeholder="nap≈ô. 9" inputmode="decimal" />
            </div>

            <div class="card" style="margin-top:12px;">
              <h3 id="dcfScenTitle">Sc√©n√°≈ôe r≈Østu (FCF)</h3>

              <div class="row">
                <label><span id="lblBear">Bear growth (%)</span> <button class="hintBtn" type="button" data-hint="bear">i</button></label>
                <input id="inpGBear" placeholder="nap≈ô. 2" inputmode="decimal" />
              </div>

              <div class="row">
                <div class="col6">
                  <label>Ticker</label>
                  <div class="field">
                    <input id="in_ticker" placeholder="nap≈ô. AAPL" />
                    <button class="helpBtn" data-help="h_ticker">?</button>
                  </div>
                  <div id="h_ticker" class="helpBox">
                    Zkratka akcie (ticker). Slou≈æ√≠ pro ulo≈æen√≠ do Watchlistu.
                  </div>
                </div>

                <div class="col6">
                  <label>Mƒõna</label>
                  <div class="field">
                    <select id="in_ccy">
                      <option value="USD">USD</option>
                      <option value="EUR">EUR</option>
                    </select>
                    <button class="helpBtn" data-help="h_ccy">?</button>
                  </div>
                  <div id="h_ccy" class="helpBox">
                    Zvol mƒõnu, ve kter√© zad√°v√°≈° FCF a cenu akcie.
                  </div>
                </div>

                <div class="col6">
                  <label>Aktu√°ln√≠ cena akcie</label>
                  <div class="field">
                    <input id="in_price" placeholder="nap≈ô. 180.50" />
                    <button class="helpBtn" data-help="h_price">?</button>
                  </div>
                  <div id="h_price" class="helpBox">
                    Aktu√°ln√≠ tr≈æn√≠ cena. Pou≈æije se pro v√Ωpoƒçet % podhodnocen√≠/nadhodnocen√≠.
                  </div>
                </div>

                <div class="col6">
                  <label>Free Cash Flow (TTM)</label>
                  <div class="field">
                    <input id="in_fcf" placeholder="nap≈ô. 1000000000" />
                    <button class="helpBtn" data-help="h_fcf">?</button>
                  </div>
                  <div id="h_fcf" class="helpBox">
                    Roƒçn√≠ voln√Ω cash flow (TTM). Zad√°vej v absolutn√≠ hodnotƒõ (nap≈ô. 1 000 000 000).
                    M≈Ø≈æe≈° ps√°t s mezerami, ƒç√°rkou i teƒçkou.
                  </div>
                </div>

                <div class="col6">
                  <label>Poƒçet akci√≠ (Shares Outstanding)</label>
                  <div class="field">
                    <input id="in_shares" placeholder="nap≈ô. 16000000000" />
                    <button class="helpBtn" data-help="h_shares">?</button>
                  </div>
                  <div id="h_shares" class="helpBox">
                    Celkov√Ω poƒçet akci√≠. V√Ωpoƒçet dƒõl√≠ hodnotu firmy poƒçtem akci√≠ ‚Üí cena na akcii.
                  </div>
                </div>

                <div class="col6">
                  <label>ƒåist√Ω dluh (Net Debt) ‚Äì voliteln√©</label>
                  <div class="field">
                    <input id="in_netdebt" placeholder="nap≈ô. 5000000000 (nebo 0)" />
                    <button class="helpBtn" data-help="h_netdebt">?</button>
                  </div>
                  <div id="h_netdebt" class="helpBox">
                    Net Debt (dluh minus hotovost). Odeƒç√≠t√° se od hodnoty firmy (EV ‚Üí Equity). Nev√≠≈°-li, dej 0.
                  </div>
                </div>

                <div class="col6">
                  <label>Diskontn√≠ sazba (r)</label>
                  <div class="field">
                    <input id="in_discount" placeholder="nap≈ô. 0.09" />
                    <button class="helpBtn" data-help="h_discount">?</button>
                  </div>
                  <div id="h_discount" class="helpBox">
                    Diskontn√≠ sazba (nap≈ô. 0.09 = 9 %). Pou≈æijeme pro diskont budouc√≠ch cash flow.
                  </div>
                </div>

                <div class="col6">
                  <label>Termin√°ln√≠ r≈Øst (g<sub>t</sub>)</label>
                  <div class="field">
                    <input id="in_tg" placeholder="nap≈ô. 0.02" />
                    <button class="helpBtn" data-help="h_tg">?</button>
                  </div>
                  <div id="h_tg" class="helpBox">
                    Dlouhodob√Ω r≈Øst po projekƒçn√≠m obdob√≠ (typicky 0.01‚Äì0.03). Mus√≠ b√Ωt men≈°√≠ ne≈æ diskontn√≠ sazba.
                  </div>
                </div>

                <div class="col6">
                  <label>Poƒçet let projekce</label>
                  <div class="field">
                    <input id="in_years" placeholder="nap≈ô. 10" />
                    <button class="helpBtn" data-help="h_years">?</button>
                  </div>
                  <div id="h_years" class="helpBox">
                    Kolik let prom√≠t√°me budouc√≠ cash flow (typicky 5‚Äì10).
                  </div>
                </div>

                <div class="col12">
                  <label>R≈Øst FCF ‚Äì 3 sc√©n√°≈ôe (BEAR / BASE / BULL)</label>
                  <div class="row">
                    <div class="col6">
                      <div class="field">
                        <input id="in_g_bear" placeholder="BEAR nap≈ô. 0.02" />
                        <button class="helpBtn" data-help="h_g_bear">?</button>
                      </div>
                      <div id="h_g_bear" class="helpBox">
                        Konzervativn√≠ r≈Øst FCF (nap≈ô. 2 % roƒçnƒõ).
                      </div>
                    </div>
                    <div class="col6">
                      <div class="field">
                        <input id="in_g_base" placeholder="BASE nap≈ô. 0.05" />
                        <button class="helpBtn" data-help="h_g_base">?</button>
                      </div>
                      <div id="h_g_base" class="helpBox">
                        Realistick√Ω r≈Øst FCF (nap≈ô. 5 % roƒçnƒõ).
                      </div>
                    </div>
                    <div class="col6">
                      <div class="field">
                        <input id="in_g_bull" placeholder="BULL nap≈ô. 0.08" />
                        <button class="helpBtn" data-help="h_g_bull">?</button>
                      </div>
                      <div id="h_g_bull" class="helpBox">
                        Optimistick√Ω r≈Øst FCF (nap≈ô. 8 % roƒçnƒõ).
                      </div>
                    </div>
                    <div class="col6">
                      <div class="field">
                        <select id="in_mos_on">
                          <option value="off">Margin of Safety: vypnuto</option>
                          <option value="on">Margin of Safety: zapnuto</option>
                        </select>
                        <button class="helpBtn" data-help="h_mos">?</button>
                      </div>
                      <div id="h_mos" class="helpBox">
                        Pokud zapne≈°, uk√°≈æeme i ‚Äúc√≠lovou cenu‚Äù jako 20% pod BASE (konzervativn√≠ n√°kupn√≠ cena).
                      </div>
                    </div>
                  </div>
                </div>
                <label><span id="lblBase">Base growth (%)</span> <button class="hintBtn" type="button" data-hint="base">i</button></label>
                <input id="inpGBase" placeholder="nap≈ô. 5" inputmode="decimal" />
              </div>

              <div class="row">
                <label><span id="lblBull">Bull growth (%)</span> <button class="hintBtn" type="button" data-hint="bull">i</button></label>
                <input id="inpGBull" placeholder="nap≈ô. 8" inputmode="decimal" />
              </div>

              <div class="btnRow">
                <button id="btn_calc" class="btn primary">Spoƒç√≠tat</button>
                <button id="btn_save" class="btn">Ulo≈æit do Watchlistu</button>
              <div class="row">
                <label><span id="lblMoS">Margin of Safety</span> <button class="hintBtn" type="button" data-hint="mos">i</button></label>
                <select id="inpMoS">
                  <option value="0">OFF</option>
                  <option value="0.2">20% pod BASE</option>
                </select>
              </div>

              <div class="note" id="dcf_msg"></div>
              <div class="rowBtns">
                <button class="btn" type="button" id="btnCalc">Spoƒç√≠tat</button>
                <button class="btn secondary" type="button" id="btnReset">Reset</button>
              </div>

              <div class="note" id="dcfNote">
                Tip: M≈Ø≈æe≈° ps√°t ƒç√≠sla i s mezerami, ƒç√°rkou nebo teƒçkou (nap≈ô. 1 234,56).
              </div>
            </div>
          </div>

          <div class="col6">
            <div class="panel">
              <h3>V√Ωsledek</h3>
              <div id="resultWrap" class="resultBox">
                <div class="note">Zadej vstupy a klikni na <b>Spoƒç√≠tat</b>. Zobraz√≠ se f√©rov√° cena pro BEAR/BASE/BULL + % rozd√≠l v≈Øƒçi aktu√°ln√≠ cenƒõ.</div>
          <div class="card">
            <h3 id="dcfOutTitle">V√Ωstupy</h3>

            <div class="results" id="results" style="display:none;">
              <div class="rbox bear">
                <div class="tag"><span>BEAR</span><span class="chip" id="chipBear">-</span></div>
                <div class="price" id="outBear">‚Äî</div>
                <div class="subline" id="subBear">‚Äî</div>
              </div>

              <div class="rbox base">
                <div class="tag"><span>BASE</span><span class="chip" id="chipBase">-</span></div>
                <div class="price" id="outBase">‚Äî</div>
                <div class="subline" id="subBase">‚Äî</div>
              </div>

              <div class="rbox bull">
                <div class="tag"><span>BULL</span><span class="chip" id="chipBull">-</span></div>
                <div class="price" id="outBull">‚Äî</div>
                <div class="subline" id="subBull">‚Äî</div>
              </div>
            </div>

            <div class="card" id="targetCard" style="margin-top:12px; display:none;">
              <h3 id="targetTitle">C√≠lov√° cena</h3>
              <div class="price" id="outTarget">‚Äî</div>
              <div class="note" id="targetNote">Margin of Safety je odvozen√Ω z BASE.</div>
            </div>

            <div class="rowBtns" style="margin-top:12px;">
              <button class="btn" type="button" id="btnSave" disabled>Ulo≈æit do Watchlistu</button>
            </div>

            <div class="note" id="saveNote">
              Watchlist ukl√°d√°: ticker, datum, mƒõnu + Bear/Base/Bull a p≈ô√≠padnƒõ Target.
            </div>
          </div>
        </div>
      </div>
    </section><!-- SCREEN: WATCHLIST -->
    <section id="screen-watchlist" class="screen" aria-hidden="true">
      <div class="screenTop">
        <h2 class="screenTitle">Watchlist ‚Äì ulo≈æen√© v√Ωpoƒçty</h2>
        <button class="backBtn" data-back>‚Üê Zpƒõt</button>
      </div>
    </section>

      <div class="content">
        <div class="panel">
          <h3>Ulo≈æen√© polo≈æky</h3>
    <section class="screen" id="screen-watch" aria-hidden="true">
      <div class="screen-head">
        <h2 id="s2Title">Watchlist</h2>
        <button class="backBtn" type="button" data-back="2" id="back2">Zpƒõt</button>
      </div>
      <div class="screen-body">
        <div class="card">
          <h3 id="wlTitle">Ulo≈æen√© v√Ωpoƒçty</h3>

          <div class="btnRow" style="margin-top:0;">
            <button id="btn_export_csv" class="btn">Export CSV</button>
            <button id="btn_clear_all" class="btn">Smazat v≈°e</button>
          <div class="rowBtns" style="margin-bottom:10px;">
            <button class="btn secondary" type="button" id="btnExportCSV">Export CSV</button>
            <button class="btn secondary" type="button" id="btnPrint">Tisk / PDF</button>
          </div>

          <div style="margin-top:12px; overflow:auto;">
            <table>
          <div id="wlEmpty" class="note">Zat√≠m nic ulo≈æen√©ho.</div>

          <div style="overflow:auto;">
            <table id="wlTable" style="display:none;">
              <thead>
                <tr>
                  <th>Datum</th>
                  <th>Ticker</th>
                  <th>Mƒõna</th>
                  <th>BEAR</th>
                  <th>BASE</th>
                  <th>BULL</th>
                  <th>MoS (BASE-20%)</th>
                  <th>Akce</th>
                  <th id="thDate">Datum</th>
                  <th id="thTicker">Ticker</th>
                  <th id="thCur">Mƒõna</th>
                  <th id="thPrice">Cena</th>
                  <th id="thBear">Bear</th>
                  <th id="thBase">Base</th>
                  <th id="thBull">Bull</th>
                  <th id="thTarget">Target</th>
                  <th id="thAct">Akce</th>
                </tr>
              </thead>
              <tbody id="wl_body">
                <tr><td colspan="8" style="color:rgba(255,255,255,.65);">Zat√≠m nic ulo≈æen√©ho.</td></tr>
              </tbody>
              <tbody id="wlBody"></tbody>
            </table>
          </div>

          <div class="note">
            Ka≈ædou polo≈æku m≈Ø≈æe≈° smazat zvl√°≈°≈• tlaƒç√≠tkem <b>‚úï</b>. Data se ukl√°daj√≠ do prohl√≠≈æeƒçe (LocalStorage).
          </div>
        </div>
      </div>
    </section>

    <!-- SCREEN: ABOUT -->
    <section id="screen-about" class="screen" aria-hidden="true">
      <div class="screenTop">
        <h2 class="screenTitle">O aplikaci</h2>
        <button class="backBtn" data-back>‚Üê Zpƒõt</button>
    <section class="screen" id="screen-about" aria-hidden="true">
      <div class="screen-head">
        <h2 id="s3Title">O aplikaci</h2>
        <button class="backBtn" type="button" data-back="3" id="back3">Zpƒõt</button>
      </div>

      <div class="content">
        <div class="panel">
          <h3>Pro koho je</h3>
          <p class="note" style="margin-top:0;">
            Tato aplikace je pro investory, kte≈ô√≠ chtƒõj√≠ umƒõt <b>sami</b> odhadnout f√©rovou cenu akcie pomoc√≠ DCF (Discounted Cash Flow).
            Nen√≠ to ‚Äúmagick√° AI rada‚Äù. Je to n√°stroj, kter√Ω tƒõ vede k tomu, abys rozumƒõl tomu, <b>co zad√°v√°≈°</b> a proƒç.
          </p>

          <h3>Jak funguje DCF v t√©to aplikaci</h3>
          <p class="note" style="margin-top:0;">
            Vezmeme v√Ωchoz√≠ <b>Free Cash Flow (TTM)</b>, prom√≠tneme ho do budoucnosti po zadan√Ω poƒçet let (projekce) a ka≈æd√Ω rok ho diskontujeme diskontn√≠ sazbou <b>r</b>.
            Po skonƒçen√≠ projekce spoƒç√≠t√°me <b>termin√°ln√≠ hodnotu</b> (Gordon≈Øv model) pomoc√≠ termin√°ln√≠ho r≈Østu <b>g<sub>t</sub></b>.
            Nakonec odeƒçteme <b>Net Debt</b> a vydƒõl√≠me poƒçtem akci√≠ ‚Üí v√Ωsledkem je <b>f√©rov√° cena na akcii</b>.
          </p>

          <h3>Co znamenaj√≠ vstupy (rychl√© vysvƒõtlen√≠)</h3>
          <ul class="note" style="margin-top:0;">
            <li><b>FCF (TTM)</b>: hotovost, kterou firma re√°lnƒõ generuje po investic√≠ch (z√°klad DCF).</li>
            <li><b>Shares Outstanding</b>: poƒçet akci√≠ ‚Äî p≈ôevod z hodnoty firmy na cenu 1 akcie.</li>
            <li><b>Diskontn√≠ sazba (r)</b>: ‚Äúcena rizika‚Äù ‚Äî ƒç√≠m vy≈°≈°√≠, t√≠m konzervativnƒõj≈°√≠ v√Ωsledek.</li>
            <li><b>R≈Øst (BEAR/BASE/BULL)</b>: t≈ôi varianty budoucnosti ‚Äî konzervativn√≠ / realistick√° / optimistick√°.</li>
            <li><b>Termin√°ln√≠ r≈Øst</b>: dlouhodob√Ω r≈Øst po projekci (typicky n√≠zk√Ω, stabiln√≠).</li>
            <li><b>Net Debt</b>: dluh minus hotovost ‚Äî odeƒç√≠t√° se od hodnoty pro akcion√°≈ôe.</li>
          </ul>

          <h3>Pozn√°mka</h3>
          <p class="note" style="margin-top:0;">
            V√Ωstup je odhad, ne jistota. DCF je citliv√Ω na vstupy ‚Äî proto tu m√°≈° 3 sc√©n√°≈ôe a volitelnƒõ Margin of Safety (20 % pod BASE).
          </p>
      <div class="screen-body">
        <div class="card" id="aboutCard">
          <!-- Text dopln√≠me v d√≠lu 6 -->
          <div class="note" id="aboutPlaceholder">Text se naƒçte‚Ä¶</div>
        </div>
      </div>
    </section>

  </div>
    <!-- HINT MODAL -->
    <div class="modal" id="hintModal" role="dialog" aria-modal="true" aria-hidden="true">
      <div class="modalCard">
        <div class="modalHead">
          <b id="hintTitle">Vysvƒõtlivka</b>
          <button class="closeX" type="button" id="hintClose">Zav≈ô√≠t</button>
        </div>
        <div class="modalBody" id="hintBody"></div>
      </div>
    </div><script>
      // ====== STATE ======
      const LS_KEY = "ea_watchlist_v1";
      let LANG = "cs";

      // ====== UI NAV ======
      const drawers = document.querySelectorAll(".drawer");
      const screens = {
        dcf: document.getElementById("screen-dcf"),
        watch: document.getElementById("screen-watch"),
        about: document.getElementById("screen-about"),
      };

  <script>// ====== Utilities (stabiln√≠ parse, ≈æ√°dn√© rozbit√≠ na ƒç√°rce) ======
    const $ = (id) => document.getElementById(id);

    function parseNum(v){
      const s = String(v ?? "")
        .trim()
        .replace(/\s+/g, "")   // mezery pryƒç
        .replace(",", ".");    // ƒç√°rka -> teƒçka
      if(!s) return NaN;
      const n = Number(s);
      return Number.isFinite(n) ? n : NaN;
    }
      function showHome(){
        Object.values(screens).forEach(s => { s.classList.remove("active"); s.setAttribute("aria-hidden","true"); });
        document.getElementById("drawers").style.display = "grid";
        window.scrollTo({top:0, behavior:"smooth"});
      }

    function fmtMoney(x, ccy){
      if(!Number.isFinite(x)) return "‚Äî";
      try{
        return new Intl.NumberFormat("cs-CZ", { style:"currency", currency: ccy, maximumFractionDigits:2 }).format(x);
      }catch{
        return `${x.toFixed(2)} ${ccy}`;
      function openScreen(key){
        document.getElementById("drawers").style.display = "none";
        Object.values(screens).forEach(s => { s.classList.remove("active"); s.setAttribute("aria-hidden","true"); });
        screens[key].classList.add("active");
        screens[key].setAttribute("aria-hidden","false");
        window.scrollTo({top:0, behavior:"smooth"});
      }
    }

    function fmtPct(x){
      if(!Number.isFinite(x)) return "‚Äî";
      const sign = x > 0 ? "+" : "";
      return `${sign}${(x*100).toFixed(1)} %`;
    }
      drawers.forEach(d => d.addEventListener("click", () => openScreen(d.dataset.screen)));
      document.querySelectorAll(".backBtn").forEach(b => b.addEventListener("click", showHome));

      // ====== PARSE NUMBERS ======
      function parseNumber(v){
        if (v === null || v === undefined) return NaN;
        let s = String(v).trim();
        if (!s) return NaN;
        // allow spaces, commas, dots
        s = s.replace(/\s+/g,"");
        // if both comma and dot exist -> assume comma thousands, dot decimal
        // else if only comma -> treat as decimal
        if (s.includes(",") && !s.includes(".")) s = s.replace(",", ".");
        // remove any non-number (except . and -)
        s = s.replace(/[^0-9.\-]/g,"");
        return Number(s);
      }

    function nowId(){
      return `${Date.now()}_${Math.random().toString(16).slice(2,8)}`;
    }
      function fmtMoney(x, cur){
        if (!isFinite(x)) return "‚Äî";
        const sym = cur === "EUR" ? "‚Ç¨" : "$";
        return sym + " " + x.toFixed(2);
      }

    function formatDate(ts){
      const d = new Date(ts);
      return d.toLocaleString("cs-CZ", { year:"numeric", month:"2-digit", day:"2-digit", hour:"2-digit", minute:"2-digit" });
    }
      function fmtPct(x){
        if (!isFinite(x)) return "‚Äî";
        const sign = x > 0 ? "+" : "";
        return sign + x.toFixed(1) + "%";
      }

    // ====== Storage (jedno m√≠sto pravdy) ======
    const WL_KEY = "ea_watchlist_v1";

    function wlLoad(){
      try{
        const raw = localStorage.getItem(WL_KEY);
        if(!raw) return { version:1, items:[] };
        const data = JSON.parse(raw);
        if(!data || !Array.isArray(data.items)) return { version:1, items:[] };
        return data;
      }catch{
        return { version:1, items:[] };
      function nowISO(){
        const d = new Date();
        const pad = n => String(n).padStart(2,"0");
        return `${d.getFullYear()}-${pad(d.getMonth()+1)}-${pad(d.getDate())} ${pad(d.getHours())}:${pad(d.getMinutes())}`;
      }
    </script><script>
      // ====== DCF LOGIC ======
      const el = id => document.getElementById(id);

      const btnCalc = el("btnCalc");
      const btnReset = el("btnReset");
      const btnSave = el("btnSave");

      function dcfPerShare(fcf, g, r, shares){
        // super jednoduch√Ω model (perpetuity) ‚Äì stabiln√≠, rychl√Ω, nez√°visl√Ω
        // fair value = FCF*(1+g) / r  / shares
        const pv = (fcf * (1 + g/100)) / (r/100);
        return pv / shares;
      }
    }

    function wlSave(data){
      localStorage.setItem(WL_KEY, JSON.stringify(data));
    }
      function valuationLine(fair, price){
        if (!isFinite(fair) || !isFinite(price) || price <= 0) return "‚Äî";
        const diff = (fair/price - 1) * 100;
        if (diff >= 0) return `${fmtPct(diff)} (podhodnocen√©)`;
        return `${fmtPct(diff)} (nadhodnocen√©)`;
      }

    function wlAdd(item){
      const data = wlLoad();
      data.items.unshift(item);
      wlSave(data);
    }
      function setResultUI(cur, price, bear, base, bull, target){
        el("results").style.display = "grid";
        el("outBear").textContent = fmtMoney(bear, cur);
        el("outBase").textContent = fmtMoney(base, cur);
        el("outBull").textContent = fmtMoney(bull, cur);

    function wlRemove(id){
      const data = wlLoad();
      data.items = data.items.filter(x => x.id !== id);
      wlSave(data);
    }
        el("subBear").textContent = valuationLine(bear, price);
        el("subBase").textContent = valuationLine(base, price);
        el("subBull").textContent = valuationLine(bull, price);

    function wlClear(){
      wlSave({ version:1, items:[] });
    }
        el("chipBear").textContent = "Fair";
        el("chipBase").textContent = "Fair";
        el("chipBull").textContent = "Fair";

    // ====== DCF core ======
    function dcfPerShare({ fcf, shares, netDebt, r, tg, years, g }){
      // projekce + diskont
      let pv = 0;
      let f = fcf;
        if (isFinite(target)){
          el("targetCard").style.display = "block";
          el("outTarget").textContent = fmtMoney(target, cur);
        } else {
          el("targetCard").style.display = "none";
        }

      for(let t=1; t<=years; t++){
        f = f * (1 + g);
        pv += f / Math.pow(1 + r, t);
        btnSave.disabled = false;
      }

      // terminal value (Gordon)
      const fN = f;
      const tv = (fN * (1 + tg)) / (r - tg);
      const pvTv = tv / Math.pow(1 + r, years);
      function clearDCF(){
        ["inpTicker","inpPrice","inpFCF","inpShares","inpDisc","inpGBear","inpGBase","inpGBull"].forEach(id => el(id).value = "");
        el("inpCurrency").value = "USD";
        el("inpMoS").value = "0";
        el("results").style.display = "none";
        el("targetCard").style.display = "none";
        btnSave.disabled = true;
      }

      const equityValue = (pv + pvTv) - netDebt;
      return equityValue / shares;
    }
      btnReset.addEventListener("click", clearDCF);

    let lastCalc = null; // ukl√°d√°me a≈æ po √∫spƒõ≈°n√©m v√Ωpoƒçtu
      btnCalc.addEventListener("click", () => {
        const ticker = (el("inpTicker").value || "").trim().toUpperCase();
        const cur = el("inpCurrency").value;

    function calcAndRender(){
      const ticker = String($("in_ticker").value || "").trim().toUpperCase();
      const ccy = $("in_ccy").value;
        const price = parseNumber(el("inpPrice").value);
        const fcf = parseNumber(el("inpFCF").value);
        const shares = parseNumber(el("inpShares").value);
        const r = parseNumber(el("inpDisc").value);

      const price = parseNum($("in_price").value);
      const fcf = parseNum($("in_fcf").value);
      const shares = parseNum($("in_shares").value);
      const netDebt = parseNum($("in_netdebt").value) || 0;
        const gBear = parseNumber(el("inpGBear").value);
        const gBase = parseNumber(el("inpGBase").value);
        const gBull = parseNumber(el("inpGBull").value);

      const r = parseNum($("in_discount").value);
      const tg = parseNum($("in_tg").value);
      const years = Math.round(parseNum($("in_years").value));
        const mos = Number(el("inpMoS").value || "0");

      const gBear = parseNum($("in_g_bear").value);
      const gBase = parseNum($("in_g_base").value);
      const gBull = parseNum($("in_g_bull").value);
        // guards
        if (!ticker) { alert(LANG==="cs" ? "Vypl≈à ticker." : "Fill the ticker."); return; }
        if (!isFinite(price) || price <= 0) { alert(LANG==="cs" ? "Zadej aktu√°ln√≠ cenu." : "Enter current price."); return; }
        if (!isFinite(fcf) || fcf <= 0) { alert(LANG==="cs" ? "Zadej FCF (TTM)." : "Enter FCF (TTM)."); return; }
        if (!isFinite(shares) || shares <= 0) { alert(LANG==="cs" ? "Zadej poƒçet akci√≠." : "Enter shares count."); return; }
        if (!isFinite(r) || r <= 0) { alert(LANG==="cs" ? "Zadej diskontn√≠ sazbu." : "Enter discount rate."); return; }
        if (!isFinite(gBear) || !isFinite(gBase) || !isFinite(gBull)) { alert(LANG==="cs" ? "Zadej r≈Østy Bear/Base/Bull." : "Enter Bear/Base/Bull growth."); return; }
        if (r <= gBull) { alert(LANG==="cs" ? "Diskontn√≠ sazba by mƒõla b√Ωt vy≈°≈°√≠ ne≈æ r≈Øst (zejm√©na Bull)." : "Discount rate should be above growth (especially Bull)."); return; }

      const mosOn = $("in_mos_on").value === "on";
        const bear = dcfPerShare(fcf, gBear, r, shares);
        const base = dcfPerShare(fcf, gBase, r, shares);
        const bull = dcfPerShare(fcf, gBull, r, shares);

      // Validace (pevn√° ‚Äì ≈æ√°dn√© ‚Äúchyb√≠ fcf‚Äù kv≈Øli ID)
      const msg = $("dcf_msg");
      msg.textContent = "";
        const target = mos > 0 ? base * (1 - mos) : NaN;

      if(!ticker){
        msg.textContent = "Zadej ticker (nap≈ô. AAPL).";
        return;
      }
      if(!Number.isFinite(price) || price <= 0){
        msg.textContent = "Zadej aktu√°ln√≠ cenu akcie (kladn√© ƒç√≠slo).";
        return;
      }
      if(!Number.isFinite(fcf) || fcf <= 0){
        msg.textContent = "Zadej Free Cash Flow (TTM) ‚Äì kladn√© ƒç√≠slo.";
        return;
      }
      if(!Number.isFinite(shares) || shares <= 0){
        msg.textContent = "Zadej poƒçet akci√≠ (Shares Outstanding) ‚Äì kladn√© ƒç√≠slo.";
        return;
      }
      if(!Number.isFinite(r) || r <= 0 || r >= 1){
        msg.textContent = "Diskontn√≠ sazba (r) mus√≠ b√Ωt mezi 0 a 1 (nap≈ô. 0.09).";
        return;
      }
      if(!Number.isFinite(tg) || tg < 0 || tg >= r){
        msg.textContent = "Termin√°ln√≠ r≈Øst (g‚Çú) mus√≠ b√Ωt >= 0 a men≈°√≠ ne≈æ r (nap≈ô. 0.02).";
        return;
      }
      if(!Number.isFinite(years) || years < 1 || years > 30){
        msg.textContent = "Poƒçet let projekce zadej jako rozumn√© cel√© ƒç√≠slo (1‚Äì30).";
        return;
      }
      if(!Number.isFinite(gBear) || !Number.isFinite(gBase) || !Number.isFinite(gBull)){
        msg.textContent = "Vypl≈à r≈Østy BEAR/BASE/BULL (nap≈ô. 0.02 / 0.05 / 0.08).";
        return;
        // store latest calc in memory for save
        window.__LAST_CALC__ = { ticker, cur, price, fcf, shares, r, gBear, gBase, gBull, bear, base, bull, target, mos, at: nowISO() };

        setResultUI(cur, price, bear, base, bull, target);
      });

      // ====== WATCHLIST STORAGE ======
      function loadWL(){
        try{
          const raw = localStorage.getItem(LS_KEY);
          const arr = raw ? JSON.parse(raw) : [];
          return Array.isArray(arr) ? arr : [];
        }catch(e){ return []; }
      }

      // v√Ωpoƒçet 3 sc√©n√°≈ô≈Ø
      let bear, base, bull;
      try{
        bear = dcfPerShare({ fcf, shares, netDebt, r, tg, years, g:gBear });
        base = dcfPerShare({ fcf, shares, netDebt, r, tg, years, g:gBase });
        bull = dcfPerShare({ fcf, shares, netDebt, r, tg, years, g:gBull });
      }catch{
        msg.textContent = "V√Ωpoƒçet selhal ‚Äì zkontroluj, zda m√°≈° r > g‚Çú a rozumn√© vstupy.";
        return;
      function saveWL(arr){
        localStorage.setItem(LS_KEY, JSON.stringify(arr));
      }

      // % vs aktu√°ln√≠ cena (kladn√© = podhodnocen√©)
      const dBear = (bear/price) - 1;
      const dBase = (base/price) - 1;
      const dBull = (bull/price) - 1;

      const mosPrice = mosOn ? (base * 0.80) : NaN; // 20% pod BASE
      const mosDelta = mosOn ? ((mosPrice/price) - 1) : NaN;

      lastCalc = {
        id: nowId(),
        createdAt: Date.now(),
        ticker,
        currency: ccy,
        inputs: { price, fcf, shares, netDebt, r, tg, years, growth:{ bear:gBear, base:gBase, bull:gBull }, mosOn },
        results: { perShare:{ bear, base, bull }, delta:{ bear:dBear, base:dBase, bull:dBull }, mosPrice, mosDelta }
      };
      btnSave.addEventListener("click", () => {
        const x = window.__LAST_CALC__;
        if (!x) return;

      renderResult(lastCalc);
      msg.textContent = "Hotovo. M≈Ø≈æe≈° ulo≈æit do Watchlistu.";
    }
        const wl = loadWL();
        wl.unshift({
          id: crypto?.randomUUID ? crypto.randomUUID() : String(Date.now()) + "_" + Math.random().toString(16).slice(2),
          ...x
        });
        saveWL(wl);
        renderWatchlist();          // defined in D√≠l 5
        openScreen("watch");
      });
                               </script><script>
      // ====== WATCHLIST UI ======
      const wlBody = document.getElementById("wlBody");
      const wlTable = document.getElementById("wlTable");
      const wlEmpty = document.getElementById("wlEmpty");

      function renderWatchlist(){
        const wl = loadWL();
        wlBody.innerHTML = "";

        if (!wl.length){
          wlEmpty.style.display = "block";
          wlTable.style.display = "none";
          return;
        }

        wlEmpty.style.display = "none";
        wlTable.style.display = "table";

        wl.forEach(item => {
          const tr = document.createElement("tr");

          const tdDate = document.createElement("td"); tdDate.textContent = item.at || "";
          const tdTicker = document.createElement("td"); tdTicker.textContent = item.ticker || "";
          const tdCur = document.createElement("td"); tdCur.textContent = item.cur || "";
          const tdPrice = document.createElement("td"); tdPrice.textContent = fmtMoney(Number(item.price), item.cur);

          const tdBear = document.createElement("td"); tdBear.textContent = fmtMoney(Number(item.bear), item.cur);
          const tdBase = document.createElement("td"); tdBase.textContent = fmtMoney(Number(item.base), item.cur);
          const tdBull = document.createElement("td"); tdBull.textContent = fmtMoney(Number(item.bull), item.cur);
          const tdTarget = document.createElement("td"); tdTarget.textContent = isFinite(Number(item.target)) ? fmtMoney(Number(item.target), item.cur) : "‚Äî";

          const tdAct = document.createElement("td");
          const del = document.createElement("button");
          del.className = "btn danger";
          del.type = "button";
          del.textContent = (LANG==="cs") ? "Smazat" : "Delete";
          del.addEventListener("click", () => {
            const wl2 = loadWL().filter(x => x.id !== item.id);
            saveWL(wl2);
            renderWatchlist();
          });
          tdAct.appendChild(del);

          [tdDate, tdTicker, tdCur, tdPrice, tdBear, tdBase, tdBull, tdTarget, tdAct].forEach(td => tr.appendChild(td));
          wlBody.appendChild(tr);
        });
      }

    function renderResult(calc){
      const ccy = calc.currency;
      const { bear, base, bull } = calc.results.perShare;
      const { bear:db, base:ds, bull:du } = calc.results.delta;
      document.getElementById("btnExportCSV").addEventListener("click", () => {
        const wl = loadWL();
        if (!wl.length){ alert(LANG==="cs" ? "Watchlist je pr√°zdn√Ω." : "Watchlist is empty."); return; }

        const header = ["date","ticker","currency","price","bear","base","bull","target"];
        const rows = wl.map(x => [
          x.at || "",
          x.ticker || "",
          x.cur || "",
          Number(x.price ?? "").toString(),
          Number(x.bear ?? "").toString(),
          Number(x.base ?? "").toString(),
          Number(x.bull ?? "").toString(),
          isFinite(Number(x.target)) ? Number(x.target).toString() : ""
        ]);

      const mosOn = calc.inputs.mosOn;
      const mosPrice = calc.results.mosPrice;
      const mosDelta = calc.results.mosDelta;
        const csv = [header, ...rows]
          .map(r => r.map(v => `"${String(v).replace(/"/g,'""')}"`).join(","))
          .join("\n");

        const blob = new Blob([csv], {type:"text/csv;charset=utf-8"});
        const url = URL.createObjectURL(blob);
        const a = document.createElement("a");
        a.href = url;
        a.download = "watchlist.csv";
        document.body.appendChild(a);
        a.click();
        a.remove();
        URL.revokeObjectURL(url);
      });

      const deltaClass = (x) => (x >= 0 ? "good" : "bad");
      const deltaTxt = (x) => (x >= 0 ? "Podhodnocen√©" : "Nadhodnocen√©");
      document.getElementById("btnPrint").addEventListener("click", () => {
        // browser print dialog -> user can Save as PDF
        window.print();
      });

      const mosHtml = mosOn ? `
        <div class="metric base">
          <p class="k">C√≠lov√° cena (MoS 20% pod BASE)</p>
          <p class="v">${fmtMoney(mosPrice, ccy)}</p>
          <div class="delta ${deltaClass(mosDelta)}">${deltaTxt(mosDelta)} ‚Ä¢ ${fmtPct(mosDelta)}</div>
        </div>
      ` : "";

      $("resultWrap").innerHTML = `
        <div class="resultGrid">
          <div class="metric bear">
            <p class="k">BEAR (konzervativn√≠)</p>
            <p class="v">${fmtMoney(bear, ccy)}</p>
            <div class="delta ${deltaClass(db)}">${deltaTxt(db)} ‚Ä¢ ${fmtPct(db)}</div>
          </div>
      // init render on load
      renderWatchlist();
                               </script><script>
      // ====== HINTS + ABOUT + I18N ======
      const modal = document.getElementById("hintModal");
      const hintTitle = document.getElementById("hintTitle");
      const hintBody = document.getElementById("hintBody");
      const hintClose = document.getElementById("hintClose");

      const TEXT = {
        cs: {
          topSubtitle: "DCF v√Ωpoƒçet ‚Ä¢ Watchlist ‚Ä¢ Popis aplikace",
          d1Desc: "V√Ωpoƒçet f√©rov√© hodnoty a 3 sc√©n√°≈ôe",
          d2Desc: "Ulo≈æen√© v√Ωpoƒçty + maz√°n√≠ polo≈æek",
          d3Title: "O aplikaci",
          d3Desc: "Pro koho je a jak funguje",
          open: "Open",
          back: "Zpƒõt",
          about: `
            <h3>Pro koho je tato aplikace</h3>
            <p>
              Tato aplikace je pro investory, kte≈ô√≠ si chtƒõj√≠ <b>sami</b> spoƒç√≠tat f√©rovou hodnotu akcie
              a rozumƒõt tomu, <b>z ƒçeho v√Ωsledek vych√°z√≠</b>.
            </p>

            <h3>Co aplikace dƒõl√°</h3>
            <ul>
              <li>Vypoƒç√≠t√° orientaƒçn√≠ f√©rovou cenu akcie (DCF ‚Äì zjednodu≈°en√Ω perpetuity model).</li>
              <li>Zobraz√≠ <b>3 sc√©n√°≈ôe</b>: Bear / Base / Bull.</li>
              <li>Volitelnƒõ spoƒç√≠t√° <b>Target</b> jako 20% Margin of Safety pod BASE.</li>
              <li>Umo≈æn√≠ ulo≈æit v√Ωpoƒçet do Watchlistu a jednotliv√© polo≈æky mazat.</li>
            </ul>

            <h3>Proƒç to nen√≠ ‚ÄûAI tip‚Äú</h3>
            <p>
              C√≠lem nen√≠ dostat ‚Äûradu‚Äú, ale m√≠t <b>transparentn√≠ v√Ωpoƒçet</b>, kter√Ω si um√≠≈° zkontrolovat.
              Je to i <b>vzdƒõl√°vac√≠ n√°stroj</b> ‚Äì uƒç√≠≈° se pracovat s kl√≠ƒçov√Ωmi vstupy (FCF, diskont, r≈Øst, poƒçet akci√≠).
            </p>

            <p class="note">
              Pozn.: V√Ωpoƒçet je zjednodu≈°en√Ω a slou≈æ√≠ jako rychl√° orientace. Pro detailn√≠ valuaci je vhodn√© doplnit v√≠celet√© projekce,
              terminal value, netto dluh a dal≈°√≠ √∫pravy.
            </p>
          `,
          hints: {
            ticker: "Ticker je burzovn√≠ zkratka firmy (nap≈ô. AAPL, MSFT).",
            price: "Aktu√°ln√≠ tr≈æn√≠ cena akcie. Slou≈æ√≠ pro v√Ωpoƒçet % nadhodnocen√≠/podhodnocen√≠.",
            currency: "Mƒõna, ve kter√© poƒç√≠t√°≈°. Jen form√°tov√°n√≠ v√Ωsledk≈Ø (USD/EUR).",
            fcf: "Free Cash Flow (TTM) ‚Äì voln√Ω cash flow za posledn√≠ch 12 mƒõs√≠c≈Ø. Z√°klad v√Ωpoƒçtu.",
            shares: "Poƒçet akci√≠ (diluted). Dƒõl√≠me j√≠m celkovou hodnotu na 1 akcii.",
            disc: "Diskontn√≠ sazba (nap≈ô. 9 %) ‚Äì po≈æadovan√° v√Ωnosnost / rizikovost.",
            bear: "Pesimistick√Ω r≈Øst FCF (%).",
            base: "Realistick√Ω r≈Øst FCF (%).",
            bull: "Optimistick√Ω r≈Øst FCF (%).",
            mos: "Margin of Safety: pokud je ON, Target = BASE * (1 - 0.20)."
          }
        },

        en: {
          topSubtitle: "DCF calculator ‚Ä¢ Watchlist ‚Ä¢ About",
          d1Desc: "Fair value estimate with 3 scenarios",
          d2Desc: "Saved calculations + delete items",
          d3Title: "About",
          d3Desc: "Who it‚Äôs for and how it works",
          open: "Open",
          back: "Back",
          about: `
            <h3>Who this app is for</h3>
            <p>
              This app is for investors who want to calculate a stock‚Äôs <b>fair value on their own</b>
              and understand <b>what drives the result</b>.
            </p>

            <h3>What it does</h3>
            <ul>
              <li>Estimates fair value per share using a simplified DCF (perpetuity model).</li>
              <li>Shows <b>3 scenarios</b>: Bear / Base / Bull.</li>
              <li>Optionally calculates a <b>Target</b> as a 20% margin of safety below BASE.</li>
              <li>Saves results to a Watchlist, where items can be deleted one by one.</li>
            </ul>

            <h3>Why this isn‚Äôt an ‚ÄúAI pick‚Äù</h3>
            <p>
              The goal is not a ‚Äútip‚Äù, but a <b>transparent calculation</b> you can verify.
              It also works as a <b>learning tool</b>‚Äîyou practice key inputs (FCF, discount rate, growth, shares).
            </p>

            <p class="note">
              Note: This is a simplified model for quick orientation. A full valuation typically includes multi-year projections,
              terminal value details, net debt adjustments, and more.
            </p>
          `,
          hints: {
            ticker: "Ticker is the stock symbol (e.g., AAPL, MSFT).",
            price: "Current market price. Used to compute % under/overvaluation.",
            currency: "Currency for displaying results (USD/EUR).",
            fcf: "Free Cash Flow (TTM) ‚Äì trailing 12 months. Core input.",
            shares: "Diluted shares outstanding. Used to convert total value to per-share value.",
            disc: "Discount rate (e.g., 9%) ‚Äì required return / risk.",
            bear: "Pessimistic FCF growth (%).",
            base: "Base-case FCF growth (%).",
            bull: "Optimistic FCF growth (%).",
            mos: "Margin of Safety: when ON, Target = BASE * (1 - 0.20)."
          }
        }
      };

          <div class="metric base">
            <p class="k">BASE (realistick√Ω)</p>
            <p class="v">${fmtMoney(base, ccy)}</p>
            <div class="delta ${deltaClass(ds)}">${deltaTxt(ds)} ‚Ä¢ ${fmtPct(ds)}</div>
          </div>
      function applyLang(){
        const t = TEXT[LANG];

          <div class="metric bull">
            <p class="k">BULL (optimistick√Ω)</p>
            <p class="v">${fmtMoney(bull, ccy)}</p>
            <div class="delta ${deltaClass(du)}">${deltaTxt(du)} ‚Ä¢ ${fmtPct(du)}</div>
          </div>
        document.documentElement.lang = LANG === "cs" ? "cs" : "en";
        document.getElementById("topSubtitle").textContent = t.topSubtitle;

          ${mosHtml}
        </div>
        document.getElementById("d1Desc").textContent = t.d1Desc;
        document.getElementById("d2Desc").textContent = t.d2Desc;

        <div class="tagRow">
          <span class="tag">Ticker: <b>${calc.ticker}</b></span>
          <span class="tag">Cena: <b>${fmtMoney(calc.inputs.price, ccy)}</b></span>
          <span class="tag">r: <b>${(calc.inputs.r*100).toFixed(2)}%</b></span>
          <span class="tag">g‚Çú: <b>${(calc.inputs.tg*100).toFixed(2)}%</b></span>
          <span class="tag">Roky: <b>${calc.inputs.years}</b></span>
        </div>
      `;
    }// ====== Watchlist render + delete + export ======
    function wlRender(){
      const data = wlLoad();
      const body = $("wl_body");

      if(data.items.length === 0){
        body.innerHTML = `<tr><td colspan="8" style="color:rgba(255,255,255,.65);">Zat√≠m nic ulo≈æen√©ho.</td></tr>`;
        return;
      }
        document.getElementById("d3Title").textContent = t.d3Title;
        document.getElementById("d3Desc").textContent = t.d3Desc;

      body.innerHTML = data.items.map(it => {
        const ccy = it.currency || "USD";
        const bear = it.results?.perShare?.bear;
        const base = it.results?.perShare?.base;
        const bull = it.results?.perShare?.bull;
        const mos = it.results?.mosPrice;

        return `
          <tr>
            <td>${formatDate(it.createdAt)}</td>
            <td><b>${it.ticker}</b></td>
            <td>${ccy}</td>
            <td>${fmtMoney(bear, ccy)}</td>
            <td>${fmtMoney(base, ccy)}</td>
            <td>${fmtMoney(bull, ccy)}</td>
            <td>${Number.isFinite(mos) ? fmtMoney(mos, ccy) : "‚Äî"}</td>
            <td>
              <button class="miniBtn" data-del="${it.id}">‚úï</button>
            </td>
          </tr>
        `;
      }).join("");

      // bind delete buttons
      body.querySelectorAll("[data-del]").forEach(btn => {
        btn.addEventListener("click", () => {
          const id = btn.getAttribute("data-del");
          wlRemove(id);
          wlRender();
        });
      });
    }
        document.getElementById("back1").textContent = t.back;
        document.getElementById("back2").textContent = t.back;
        document.getElementById("back3").textContent = t.back;

    function exportCSV(){
      const data = wlLoad();
      if(!data.items.length){
        alert("Watchlist je pr√°zdn√Ω.");
        return;
      }
      const rows = [["createdAt","date","ticker","currency","bear","base","bull","mosBaseMinus20"]];
      data.items.forEach(it=>{
        const ccy = it.currency || "USD";
        rows.push([
          it.createdAt,
          formatDate(it.createdAt),
          it.ticker,
          ccy,
          it.results?.perShare?.bear ?? "",
          it.results?.perShare?.base ?? "",
          it.results?.perShare?.bull ?? "",
          it.results?.mosPrice ?? ""
        ]);
      });
        document.getElementById("aboutCard").innerHTML = t.about;

      const csv = rows.map(r => r.map(v => `"${String(v).replaceAll('"','""')}"`).join(",")).join("\n");
      const blob = new Blob([csv], { type:"text/csv;charset=utf-8" });
      const url = URL.createObjectURL(blob);
      const a = document.createElement("a");
      a.href = url;
      a.download = "watchlist.csv";
      document.body.appendChild(a);
      a.click();
      a.remove();
      URL.revokeObjectURL(url);
    }
        // buttons in watchlist rows need re-render to update label
        renderWatchlist();
      }

    // ====== Navigation (≈°upl√≠ky = screens) ======
    const screens = {
      dcf: $("screen-dcf"),
      watchlist: $("screen-watchlist"),
      about: $("screen-about")
    };

    function openScreen(key){
      // hide home
      $("home").style.display = "none";
      // hide all screens
      Object.values(screens).forEach(s => {
        s.classList.remove("active");
        s.setAttribute("aria-hidden","true");
      // language buttons
      const bCS = document.getElementById("langCS");
      const bEN = document.getElementById("langEN");
      bCS.addEventListener("click", () => {
        LANG = "cs";
        bCS.classList.add("active"); bEN.classList.remove("active");
        applyLang();
      });
      // show selected
      const sc = screens[key];
      sc.classList.add("active");
      sc.setAttribute("aria-hidden","false");

      if(key === "watchlist") wlRender();
      window.scrollTo({ top:0, behavior:"instant" });
    }

    function goHome(){
      Object.values(screens).forEach(s => {
        s.classList.remove("active");
        s.setAttribute("aria-hidden","true");
      bEN.addEventListener("click", () => {
        LANG = "en";
        bEN.classList.add("active"); bCS.classList.remove("active");
        applyLang();
      });
      $("home").style.display = "";
      window.scrollTo({ top:0, behavior:"instant" });
    }

    // ====== Events ======
    document.querySelectorAll("[data-open]").forEach(btn=>{
      btn.addEventListener("click", ()=>{
        openScreen(btn.getAttribute("data-open"));
      });
    });

    document.querySelectorAll("[data-back]").forEach(btn=>{
      btn.addEventListener("click", goHome);
    });

    // Help toggles
    document.querySelectorAll("[data-help]").forEach(btn=>{
      btn.addEventListener("click", ()=>{
        const id = btn.getAttribute("data-help");
        const box = $(id);
        box.classList.toggle("open");
      // hints
      document.querySelectorAll(".hintBtn").forEach(btn => {
        btn.addEventListener("click", () => {
          const key = btn.dataset.hint;
          const t = TEXT[LANG];
          hintTitle.textContent = (LANG==="cs") ? "Vysvƒõtlivka" : "Explanation";
          hintBody.textContent = t.hints[key] || "‚Äî";
          modal.classList.add("open");
          modal.setAttribute("aria-hidden","false");
        });
      });
    });

    $("btn_calc").addEventListener("click", calcAndRender);

    $("btn_save").addEventListener("click", ()=>{
      const msg = $("dcf_msg");
      if(!lastCalc){
        msg.textContent = "Nejd≈ô√≠v klikni na Spoƒç√≠tat, a≈æ pak ukl√°dej.";
        return;
      }
      wlAdd(lastCalc);
      msg.textContent = "Ulo≈æeno do Watchlistu.";
    });

    $("btn_clear_all").addEventListener("click", ()=>{
      if(confirm("Opravdu smazat cel√Ω Watchlist?")){
        wlClear();
        wlRender();
      function closeModal(){
        modal.classList.remove("open");
        modal.setAttribute("aria-hidden","true");
      }
    });
      hintClose.addEventListener("click", closeModal);
      modal.addEventListener("click", (e) => { if (e.target === modal) closeModal(); });
      document.addEventListener("keydown", (e) => { if (e.key === "Escape") closeModal(); });

    $("btn_export_csv").addEventListener("click", exportCSV);
      // initial
      applyLang();
    </script>

    // init
    wlRender();
  </script>
  </div>
</body>
</html>








  

  

  


  


    


      

   

  

    

          
    

    

    
    


    





    

    

  
        

    
    

  

  





