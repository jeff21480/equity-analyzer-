<!doctype html>
<html lang="cs">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Anal√Ωza akci√≠ ‚Äì MVP</title>
  <meta name="description" content="DCF odhad vnit≈ôn√≠ hodnoty (Bear/Base/Bull), watchlist a slo≈æen√© √∫roƒçen√≠." />

  <style>
    :root{
      --bg1:#120a2a;
      --bg2:#0b1f5a;

      --card: rgba(255,255,255,.09);
      --card2: rgba(255,255,255,.06);
      --stroke: rgba(255,255,255,.14);
      --stroke2: rgba(255,255,255,.10);

      --text: rgba(255,255,255,.92);
      --muted: rgba(255,255,255,.70);

      --accent:#8b5cf6;
      --accent2:#46c2ff;
      --ok:#22c55e;
      --bad:#ef4444;
      --warn:#f59e0b;
    }

    *{box-sizing:border-box}
    body{
      margin:0;
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial, "Apple Color Emoji","Segoe UI Emoji";
      color:var(--text);
      background:
        radial-gradient(1200px 800px at 20% 10%, rgba(139,92,246,.35), transparent 55%),
        radial-gradient(900px 600px at 80% 20%, rgba(70,194,255,.25), transparent 55%),
        linear-gradient(160deg, var(--bg1), var(--bg2));
      min-height:100vh;
    }

    .wrap{
      max-width:820px;
      margin:0 auto;
      padding:18px 14px 60px;
    }

    .topbar{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:12px;
      padding:8px 4px 14px;
    }

    .badge{
      display:inline-flex;
      align-items:center;
      gap:8px;
      padding:8px 12px;
      border-radius:999px;
      background:rgba(255,255,255,.08);
      border:1px solid var(--stroke);
      backdrop-filter: blur(8px);
      font-size:12px;
      color:var(--muted);
    }
    .dot{
      width:10px;height:10px;border-radius:50%;
      background: radial-gradient(circle at 30% 30%, #fff, var(--accent2));
      box-shadow: 0 0 18px rgba(70,194,255,.6);
    }

    h1{
      margin:6px 4px 6px;
      font-size:44px;
      line-height:1.05;
      letter-spacing:.3px;
      font-weight:800;
    }
    .subtitle{
      margin:0 4px 18px;
      color:var(--muted);
      font-size:15px;
      line-height:1.5;
      max-width:62ch;
    }

    .menu{
      display:flex;
      flex-direction:column;
      gap:12px;
      margin-top:8px;
    }

    .tile{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:14px;
      padding:16px 16px;
      border-radius:22px;
      background: linear-gradient(180deg, rgba(255,255,255,.10), rgba(255,255,255,.06));
      border:1px solid var(--stroke);
      box-shadow: 0 14px 30px rgba(0,0,0,.25);
      cursor:pointer;
      user-select:none;
      transition: transform .08s ease, border-color .12s ease;
    }
    .tile:active{ transform: translateY(1px); }
    .tile:hover{ border-color: rgba(255,255,255,.22); }

    .tileLeft{
      display:flex;
      align-items:center;
      gap:14px;
      min-width:0;
    }

    .icon{
      width:52px;height:52px;
      border-radius:18px;
      background: rgba(255,255,255,.10);
      border:1px solid var(--stroke2);
      display:grid;
      place-items:center;
      font-size:24px;
      box-shadow: inset 0 0 0 1px rgba(255,255,255,.05);
    }

    .tileTitle{
      font-size:28px;
      font-weight:800;
      margin:0;
      line-height:1.05;
    }
    .tileSub{
      margin:4px 0 0;
      color:var(--muted);
      font-size:13px;
      line-height:1.35;
      white-space:nowrap;
      overflow:hidden;
      text-overflow:ellipsis;
    }

    .arrow{
      font-size:22px;
      color:rgba(255,255,255,.7);
      margin-left:8px;
    }

    .screen{
      display:none;
      animation: fadeIn .16s ease;
    }
    .screen.active{ display:block; }

    @keyframes fadeIn{
      from{ opacity:.6; transform: translateY(4px); }
      to{ opacity:1; transform: translateY(0); }
    }

    .headerRow{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:10px;
      margin:8px 2px 12px;
    }

    .back{
      display:inline-flex;
      align-items:center;
      gap:10px;
      padding:10px 12px;
      border-radius:16px;
      background:rgba(255,255,255,.08);
      border:1px solid var(--stroke);
      cursor:pointer;
      user-select:none;
      font-weight:700;
      color:var(--text);
      transition: border-color .12s ease;
    }
    .back:hover{ border-color: rgba(255,255,255,.22); }

    .pillMini{
      display:inline-flex;
      align-items:center;
      gap:8px;
      padding:8px 12px;
      border-radius:999px;
      background: rgba(139,92,246,.16);
      border:1px solid rgba(139,92,246,.35);
      color: rgba(255,255,255,.86);
      font-size:12px;
      font-weight:700;
    }

    .card{
      border-radius:22px;
      background: linear-gradient(180deg, rgba(255,255,255,.10), rgba(255,255,255,.05));
      border:1px solid var(--stroke);
      box-shadow: 0 14px 30px rgba(0,0,0,.25);
      padding:16px;
      margin:12px 0;
    }

    .panelTitle{
      font-weight:900;
      letter-spacing:.2px;
      font-size:15px;
      margin:0 0 6px;
      color: rgba(255,255,255,.92);
    }
    .subTitle{
      margin:0 0 12px;
      color: var(--muted);
      font-size:13px;
      line-height:1.45;
    }

    .grid{
      display:grid;
      gap:12px;
    }
    .grid.two{ grid-template-columns: 1fr 1fr; }
    .grid.three{ grid-template-columns: 1fr 1fr 1fr; }
    @media (max-width: 720px){
      .grid.two, .grid.three{ grid-template-columns: 1fr; }
      h1{ font-size:40px; }
      .tileTitle{ font-size:26px; }
    }

    label{
      display:block;
      font-size:12px;
      color: rgba(255,255,255,.80);
      margin:0 0 8px;
      font-weight:800;
      letter-spacing:.2px;
    }

    input{
      width:100%;
      padding:12px 12px;
      border-radius:16px;
      border:1px solid rgba(255,255,255,.14);
      background: rgba(0,0,0,.22);
      color: var(--text);
      outline:none;
      font-size:14px;
      transition: border-color .12s ease, box-shadow .12s ease;
    }
    input:focus{
      border-color: rgba(70,194,255,.45);
      box-shadow: 0 0 0 4px rgba(70,194,255,.12);
    }

    .row{
      display:flex;
      gap:10px;
      flex-wrap:wrap;
      align-items:center;
      margin-top:12px;
    }

    .btn{
      appearance:none;
      border:1px solid rgba(255,255,255,.16);
      background: rgba(255,255,255,.08);
      color: var(--text);
      padding:12px 14px;
      border-radius:16px;
      font-weight:900;
      cursor:pointer;
      user-select:none;
      transition: transform .08s ease, border-color .12s ease, background .12s ease;
    }
    .btn:active{ transform: translateY(1px); }
    .btn:hover{ border-color: rgba(255,255,255,.24); }

    .btn.primary{
      background: linear-gradient(135deg, rgba(139,92,246,.95), rgba(70,194,255,.65));
      border-color: rgba(255,255,255,.18);
      box-shadow: 0 14px 28px rgba(139,92,246,.18);
    }

    .btn.danger{
      background: rgba(239,68,68,.12);
      border-color: rgba(239,68,68,.25);
    }

    .divider{
      height:1px;
      background: rgba(255,255,255,.10);
      margin:14px 0;
    }

    details{
      border-radius:16px;
      border:1px solid rgba(255,255,255,.12);
      background: rgba(255,255,255,.06);
      padding:10px 12px;
      margin-top:10px;
    }
    summary{
      cursor:pointer;
      user-select:none;
      font-weight:900;
      color: rgba(255,255,255,.86);
      list-style:none;
    }
    summary::-webkit-details-marker{ display:none; }
    .helpText{
      margin:10px 0 0;
      color: rgba(255,255,255,.78);
      font-size:13px;
      line-height:1.55;
    }
    .helpText b{ color: rgba(255,255,255,.92); }

    .resultBox{
      display:none;
      border-radius:22px;
      border:1px solid rgba(255,255,255,.14);
      background: rgba(0,0,0,.22);
      padding:14px;
      margin-top:14px;
    }
    .resultHead{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:10px;
      margin-bottom:10px;
    }
    .resultTitle{
      font-weight:1000;
      font-size:14px;
      letter-spacing:.2px;
      margin:0;
    }
    .tiny{
      font-size:12px;
      color: rgba(255,255,255,.70);
      margin:0;
    }

    table{
      width:100%;
      border-collapse:collapse;
      overflow:hidden;
      border-radius:18px;
      border:1px solid rgba(255,255,255,.10);
    }
    th, td{
      padding:10px 10px;
      border-bottom:1px solid rgba(255,255,255,.08);
      text-align:left;
      font-size:13px;
    }
    th{
      color: rgba(255,255,255,.78);
      font-weight:900;
      background: rgba(255,255,255,.06);
    }
    tr:last-child td{ border-bottom:none; }

    .pill{
      display:inline-flex;
      align-items:center;
      gap:8px;
      padding:6px 10px;
      border-radius:999px;
      font-weight:1000;
      font-size:12px;
      border:1px solid rgba(255,255,255,.14);
      background: rgba(255,255,255,.06);
      white-space:nowrap;
    }
    .pill.ok{
      border-color: rgba(34,197,94,.28);
      background: rgba(34,197,94,.10);
    }
    .pill.bad{
      border-color: rgba(239,68,68,.28);
      background: rgba(239,68,68,.10);
    }
    .pill.neu{
      border-color: rgba(245,158,11,.25);
      background: rgba(245,158,11,.10);
    }

    .wlItem{
      border-radius:22px;
      border:1px solid rgba(255,255,255,.12);
      background: rgba(255,255,255,.06);
      padding:14px;
      margin-top:12px;
    }
    .wlTop{
      display:flex;
      align-items:flex-start;
      justify-content:space-between;
      gap:12px;
    }
    .wlTitle{
      margin:0;
      font-size:16px;
      font-weight:1000;
      letter-spacing:.2px;
    }
    .wlMeta{
      margin:6px 0 0;
      color: rgba(255,255,255,.72);
      font-size:12px;
      line-height:1.35;
    }
    .wlBtns{
      display:flex;
      gap:8px;
      flex-wrap:wrap;
      justify-content:flex-end;
    }

    .msg{
      margin-top:10px;
      font-size:13px;
      color: rgba(255,255,255,.78);
    }
  </style>
</head>

<body>
  <div class="wrap">

    <!-- HOME -->
    <section id="screen-home" class="screen active">
      <div class="topbar">
        <div class="badge"><span class="dot"></span> Anal√Ωza akci√≠ ‚Ä¢ Beta</div>
        <div class="badge">MVP</div>
      </div>

      <h1>Anal√Ωza akci√≠</h1>
      <p class="subtitle">
        Jednoduch√Ω n√°stroj pro odhad vnit≈ôn√≠ hodnoty pomoc√≠ DCF (Bear / Base / Bull),
        ukl√°d√°n√≠ do watchlistu a p≈ôehledn√© vysvƒõtlivky u ka≈æd√©ho pole.
      </p>

      <div class="menu">
        <div class="tile" data-open="analyzer">
          <div class="tileLeft">
            <div class="icon">üìà</div>
            <div style="min-width:0">
              <div class="tileTitle">Analyz√°tor</div>
              <div class="tileSub">Odhad vnit≈ôn√≠ hodnoty (Bear / Base / Bull)</div>
            </div>
          </div>
          <div class="arrow">‚Ä∫</div>
        </div>

        <div class="tile" data-open="calculator">
          <div class="tileLeft">
            <div class="icon">üßÆ</div>
            <div style="min-width:0">
              <div class="tileTitle">Kalkulaƒçka</div>
              <div class="tileSub">Slo≈æen√© √∫roƒçen√≠ + c√≠lov√° ƒç√°stka</div>
            </div>
          </div>
          <div class="arrow">‚Ä∫</div>
        </div>

        <div class="tile" data-open="watchlist">
          <div class="tileLeft">
            <div class="icon">üëÄ</div>
            <div style="min-width:0">
              <div class="tileTitle">Watchlist</div>
              <div class="tileSub">Ulo≈æen√© anal√Ωzy (ka≈ædou m≈Ø≈æe≈° smazat zvl√°≈°≈•)</div>
            </div>
          </div>
          <div class="arrow">‚Ä∫</div>
        </div>

        <div class="tile" data-open="about">
          <div class="tileLeft">
            <div class="icon">‚ÑπÔ∏è</div>
            <div style="min-width:0">
              <div class="tileTitle">Jak to funguje</div>
              <div class="tileSub">Pro koho to je, proƒç to existuje, co je DCF</div>
            </div>
          </div>
          <div class="arrow">‚Ä∫</div>
        </div>
      </div>
    </section>

    <!-- ANALYZER -->
    <section id="screen-analyzer" class="screen">
      <div class="headerRow">
        <div class="back" data-open="home">‚Üê Zpƒõt</div>
        <div class="pillMini">DCF ‚Ä¢ Bear / Base / Bull</div>
      </div>

      <div class="card">
        <div class="panelTitle">Vstupy</div>
        <p class="subTitle">
          Vypl≈à z√°kladn√≠ vstupy pro Base sc√©n√°≈ô. N√°stroj pak dopoƒç√≠t√° Bear a Bull podle √∫prav n√≠≈æe.
          Vysvƒõtlivky jsou schovan√© pod jednotliv√Ωmi sekcemi.
        </p>

        <div class="grid two">
          <div>
            <label for="a_ticker">Ticker (voliteln√©)</label>
            <input id="a_ticker" type="text" placeholder="nap≈ô. SOFI" />
          </div>
          <div>
            <label for="a_price">Aktu√°ln√≠ cena (na 1 akcii)</label>
            <input id="a_price" type="text" inputmode="decimal" placeholder="nap≈ô. 8,50" />
          </div>
        </div>

        <div class="divider"></div>

        <div class="grid two">
          <div>
            <label for="a_fcfps">FCF na akcii (TTM / posledn√≠ rok)</label>
            <input id="a_fcfps" type="text" inputmode="decimal" placeholder="nap≈ô. 0,62" />
          </div>
          <div>
            <label for="a_years">Poƒçet let projekce</label>
            <input id="a_years" type="text" inputmode="numeric" placeholder="nap≈ô. 10" />
          </div>
        </div>

        <div class="grid two" style="margin-top:12px;">
          <div>
            <label for="a_g">R≈Øst FCF (Base) %</label>
            <input id="a_g" type="text" inputmode="decimal" placeholder="nap≈ô. 10" />
          </div>
          <div>
            <label for="a_r">Diskontn√≠ sazba (Base) %</label>
            <input id="a_r" type="text" inputmode="decimal" placeholder="nap≈ô. 9" />
          </div>
        </div>

        <div class="grid two" style="margin-top:12px;">
          <div>
            <label for="a_tg">Termin√°ln√≠ r≈Øst (Base) %</label>
            <input id="a_tg" type="text" inputmode="decimal" placeholder="nap≈ô. 2,5" />
          </div>
          <div>
            <label for="a_shares">Poƒçet akci√≠ (voliteln√©)</label>
            <input id="a_shares" type="text" inputmode="decimal" placeholder="nech pr√°zdn√© (poƒç√≠t√°me na akcii)" />
          </div>
        </div>

        <details>
          <summary>Co ty vstupy znamenaj√≠?</summary>
          <div class="helpText">
            <p style="margin:0 0 10px;">
              <b>Poƒç√≠t√°me DCF na jednu akcii.</b> To znamen√°, ≈æe jako vstup staƒç√≠ <b>FCF na akcii</b>
              (voln√Ω cash flow p≈ôepoƒçten√Ω na 1 akcii) a v≈°e se prom√≠tne do f√©rov√© ceny na 1 akcii.
            </p>
            <p style="margin:0 0 10px;">
              <b>Aktu√°ln√≠ cena</b> slou≈æ√≠ jen pro v√Ωpoƒçet, jestli je akcie <b>pod/nadhodnocen√°</b> a o kolik %.
            </p>
            <p style="margin:0 0 10px;">
              <b>R≈Øst FCF</b> je odhad, o kolik % roƒçnƒõ poroste FCF v projekci.
              <b>Diskontn√≠ sazba</b> je po≈æadovan√Ω v√Ωnos (nap≈ô. 9 %).
              <b>Termin√°ln√≠ r≈Øst</b> je dlouhodob√Ω r≈Øst po projekci (typicky 2‚Äì3 %).
            </p>
            <p style="margin:0;">
              ƒå√≠sla m≈Ø≈æe≈° ps√°t i <b>s desetinnou ƒç√°rkou</b> (nap≈ô. <b>9,5</b>). Funguje i teƒçka.
            </p>
          </div>
        </details>
      </div>

      <div class="card">
        <div class="panelTitle">Sc√©n√°≈ôe (√∫pravy v≈Øƒçi Base)</div>
        <p class="subTitle">
          √öpravy jsou v procentn√≠ch bodech (p.b.). Nap≈ô. +2 p.b. r≈Østu znamen√°: Base r≈Øst 8 % ‚Üí Bull r≈Øst 10 %.
        </p>

        <div class="grid three">
          <div>
            <label for="a_bear_g">Bear √∫prava r≈Østu (p.b.)</label>
            <input id="a_bear_g" type="text" inputmode="decimal" placeholder="nap≈ô. -2" />
          </div>
          <div>
            <label for="a_bear_r">Bear √∫prava diskontu (p.b.)</label>
            <input id="a_bear_r" type="text" inputmode="decimal" placeholder="nap≈ô. +1" />
          </div>
          <div>
            <label for="a_bear_tg">Bear √∫prava termin√°lu (p.b.)</label>
            <input id="a_bear_tg" type="text" inputmode="decimal" placeholder="nap≈ô. -0,5" />
          </div>
        </div>

        <div class="grid three" style="margin-top:12px;">
          <div>
            <label for="a_bull_g">Bull √∫prava r≈Østu (p.b.)</label>
            <input id="a_bull_g" type="text" inputmode="decimal" placeholder="nap≈ô. +2" />
          </div>
          <div>
            <label for="a_bull_r">Bull √∫prava diskontu (p.b.)</label>
            <input id="a_bull_r" type="text" inputmode="decimal" placeholder="nap≈ô. -1" />
          </div>
          <div>
            <label for="a_bull_tg">Bull √∫prava termin√°lu (p.b.)</label>
            <input id="a_bull_tg" type="text" inputmode="decimal" placeholder="nap≈ô. +0,5" />
          </div>
        </div>

        <details>
          <summary>Jak sc√©n√°≈ôe ƒç√≠st?</summary>
          <div class="helpText">
            <p style="margin:0 0 10px;">
              <b>Base</b> je ‚Äûnejpravdƒõpodobnƒõj≈°√≠‚Äú odhad (podle tebe).
              <b>Bear</b> je konzervativnƒõj≈°√≠ (ni≈æ≈°√≠ r≈Øst, vy≈°≈°√≠ diskont, ni≈æ≈°√≠ termin√°l).
              <b>Bull</b> je optimistiƒçtƒõj≈°√≠ (vy≈°≈°√≠ r≈Øst, ni≈æ≈°√≠ diskont, vy≈°≈°√≠ termin√°l).
            </p>
            <p style="margin:0;">
              Sc√©n√°≈ôe z√°mƒõrnƒõ ukazuj√≠ <b>rozpƒõt√≠</b> mo≈æn√Ωch v√Ωsledk≈Ø. Nejde o vƒõ≈°tƒõn√≠, ale o citlivost modelu.
            </p>
          </div>
        </details>

        <div class="row">
          <button class="btn primary" id="btnCalc">Spoƒç√≠tat</button>
          <button class="btn" id="btnSave">Ulo≈æit do Watchlistu</button>
          <button class="btn danger" id="btnResetA">Vyƒçistit</button>
        </div>

        <div class="msg" id="calcMsg"></div>

        <div id="resultBox" class="resultBox">
          <div class="resultHead">
            <div>
              <p class="resultTitle">V√Ωsledek (vnit≈ôn√≠ hodnota na 1 akcii)</p>
              <p class="tiny" id="resultMeta"></p>
            </div>
            <div class="pillMini" id="resultBadge">V√Ωpoƒçet</div>
          </div>

          <table>
            <thead>
              <tr>
                <th>Sc√©n√°≈ô</th>
                <th>Vnit≈ôn√≠ hodnota</th>
                <th>Rozd√≠l vs. cena</th>
              </tr>
            </thead>
            <tbody id="resultRows"></tbody>
          </table>

          <details style="margin-top:12px;">
            <summary>Metodika v√Ωpoƒçtu (struƒçnƒõ)</summary>
            <div class="helpText">
              <p style="margin:0 0 10px;">
                Projekce: FCF roste konstantn√≠m tempem po zadan√Ω poƒçet let. Ka≈æd√Ω rok se diskontuje
                zadanou diskontn√≠ sazbou.
              </p>
              <p style="margin:0;">
                Termin√°l: po projekci se dopoƒç√≠t√° termin√°ln√≠ hodnota pomoc√≠ Gordonova vzorce
                (FCF<sub>n</sub> √ó (1 + g) / (r ‚àí g)) a tak√© se diskontuje.
              </p>
            </div>
          </details>
        </div>
      </div>
    </section>

    <!-- COMPOUND INTEREST -->
    <section id="screen-calculator" class="screen">
      <div class="headerRow">
        <div class="back" data-open="home">‚Üê Zpƒõt</div>
        <div class="pillMini">Slo≈æen√© √∫roƒçen√≠</div>
      </div>

      <div class="card">
        <div class="panelTitle">Vstupy</div>
        <p class="subTitle">Kalkulaƒçka je pomocn√°. Vysvƒõtlivky jsou schovan√© uvnit≈ô.</p>

        <div class="grid two">
          <div>
            <label for="c_start">Poƒç√°teƒçn√≠ vklad</label>
            <input id="c_start" type="text" inputmode="decimal" placeholder="nap≈ô. 50 000" />
          </div>
          <div>
            <label for="c_monthly">Mƒõs√≠ƒçn√≠ vklad</label>
            <input id="c_monthly" type="text" inputmode="decimal" placeholder="nap≈ô. 2 000" />
          </div>
        </div>

        <div class="grid two" style="margin-top:12px;">
        <div>
          <label for="c_rate">Roƒçn√≠ zhodnocen√≠ %</label>
          <input id="c_rate" type="text" inputmode="decimal" placeholder="nap≈ô. 7" />
        </div>
        <div>
          <label for="c_years">Poƒçet let</label>
          <input id="c_years" type="text" inputmode="numeric" placeholder="nap≈ô. 20" />
        </div>
      </div>

      <div class="divider"></div>

      <div class="grid two">
        <div>
          <label for="c_target">C√≠lov√° ƒç√°stka (voliteln√©)</label>
          <input id="c_target" type="text" inputmode="decimal" placeholder="nap≈ô. 2 000 000" />
        </div>
        <div>
          <label for="c_note">Pozn√°mka (voliteln√©)</label>
          <input id="c_note" type="text" placeholder="nap≈ô. D√≠tƒõ / d≈Øchod" />
        </div>
      </div>

      <details>
        <summary>Co je dovoleno zad√°vat?</summary>
        <div class="helpText">
          <p style="margin:0;">
            M≈Ø≈æe≈° ps√°t ƒç√≠sla s mezerami (nap≈ô. <b>1 000 000</b>) a desetinnou ƒç√°rkou (<b>9,5</b>).
            Funguje i teƒçka.
          </p>
        </div>
      </details>

      <div class="row">
        <button class="btn primary" id="btnCalcCI">Spoƒç√≠tat</button>
        <button class="btn danger" id="btnResetCI">Vyƒçistit</button>
      </div>

      <div class="msg" id="ciMsg"></div>

      <div id="ciResult" class="resultBox">
        <div class="resultHead">
          <div>
            <p class="resultTitle">V√Ωsledek</p>
            <p class="tiny" id="ciKpi"></p>
          </div>
          <div class="pillMini">V√Ωpoƒçet</div>
        </div>

        <table>
          <thead>
            <tr>
              <th>Polo≈æka</th>
              <th>Hodnota</th>
            </tr>
          </thead>
          <tbody id="ciRows"></tbody>
        </table>
      </div>
    </div>
  </section>

  <!-- WATCHLIST -->
  <section id="screen-watchlist" class="screen">
    <div class="headerRow">
      <div class="back" data-open="home">‚Üê Zpƒõt</div>
      <div class="pillMini">Watchlist</div>
    </div>

    <div class="card">
      <div class="panelTitle">Ulo≈æen√© anal√Ωzy</div>
      <p class="subTitle">
        Ka≈ædou polo≈æku m≈Ø≈æe≈° <b>otev≈ô√≠t</b> (naƒç√≠st zpƒõt do analyz√°toru) nebo <b>smazat</b> zvl√°≈°≈•.
      </p>

      <div class="row">
        <button class="btn danger" id="btnClearAll">Smazat cel√Ω watchlist</button>
      </div>

      <div class="msg" id="wlMsg"></div>
      <div id="wlList"></div>
    </div>
  </section>

  <!-- ABOUT -->
  <section id="screen-about" class="screen">
    <div class="headerRow">
      <div class="back" data-open="home">‚Üê Zpƒõt</div>
      <div class="pillMini">Jak to funguje</div>
    </div>

    <div class="card">
      <div class="panelTitle">Pro koho to je</div>
      <p class="subTitle">
        Tahle aplikace je pro investory, kte≈ô√≠ si chtƒõj√≠ <b>udƒõlat vlastn√≠ n√°zor</b> na f√©rovou cenu akcie.
        Neslibuje ‚Äûzaruƒçen√© tipy‚Äú, ale nab√≠z√≠ jednoduch√Ω r√°mec, kter√Ω si um√≠≈° zkontrolovat a pochopit.
      </p>

      <div class="divider"></div>

      <div class="panelTitle">Proƒç DCF</div>
      <p class="subTitle">
        DCF (Discounted Cash Flow) je model, kter√Ω p≈ôekl√°d√° budouc√≠ cash flow firmy do dne≈°n√≠ hodnoty.
        V praxi: firma m√° cenu podle toho, kolik hotovosti dok√°≈æe dlouhodobƒõ generovat (a jakou n√°vratnost po≈æaduje≈°).
      </p>

      <details>
        <summary>Co je na tom u≈æiteƒçn√©?</summary>
        <div class="helpText">
          <p style="margin:0 0 10px;">
            1) <b>Uƒç√≠ tƒõ p≈ôem√Ω≈°let o p≈ôedpokladech</b> (r≈Øst, riziko, termin√°l).<br/>
            2) Ukazuje <b>citlivost</b> ‚Äì proto m√°me Bear/Base/Bull.<br/>
            3) Pom√°h√° filtrovat ‚Äûhype‚Äú ‚Äì kdy≈æ ƒç√≠sla nevych√°z√≠, v√≠≈° proƒç.
          </p>
          <p style="margin:0;">
            DCF nen√≠ k≈ôi≈°≈•√°lov√° koule. Je to <b>n√°stroj</b> pro discipl√≠nu a porovn√°v√°n√≠ sc√©n√°≈ô≈Ø.
          </p>
        </div>
      </details>

      <div class="divider"></div>

      <div class="panelTitle">D≈Øle≈æit√© upozornƒõn√≠</div>
      <p class="subTitle" style="margin-bottom:0;">
        V√Ωsledky nejsou investiƒçn√≠ doporuƒçen√≠. Je to model zalo≈æen√Ω na tv√Ωch vstupech.
        Nejvƒõt≈°√≠ hodnota je v tom, ≈æe v√≠≈°, <b>co</b> do modelu d√°v√°≈° a <b>proƒç</b>.
      </p>
    </div>
  </section>

</div>

<script>
  // ===== Helpers =====
  const $ = (sel) => document.querySelector(sel);
  const $$ = (sel) => Array.from(document.querySelectorAll(sel));

  function showScreen(name){
    $$(".screen").forEach(s => s.classList.remove("active"));
    $("#screen-" + name).classList.add("active");
    if(name === "watchlist") renderWatchlist();
  }

  // decimal parsing: accepts "9,5" "9.5" "1 000" etc
  function parseNum(v){
    if(v == null) return NaN;
    const s = String(v)
      .trim()
      .replace(/\s+/g,"")
      .replace(",",".")
      .replace(/[^\d.\-+]/g,"");
    const n = Number(s);
    return Number.isFinite(n) ? n : NaN;
  }

  function fmtMoney(n){
    if(!Number.isFinite(n)) return "‚Äî";
    return n.toLocaleString("cs-CZ", { maximumFractionDigits: 2 });
  }
  function fmtPct(n){
    if(!Number.isFinite(n)) return "‚Äî";
    const sign = n > 0 ? "+" : "";
    return sign + n.toLocaleString("cs-CZ", { maximumFractionDigits: 1 }) + " %";
  }

  function setMsg(id, text){
    $(id).textContent = text || "";
  }

  // ===== Navigation =====
  $$(".tile, .back").forEach(el => {
    el.addEventListener("click", () => {
      const target = el.getAttribute("data-open");
      if(target) showScreen(target);
    });
  });

  // ===== DCF core (per share) =====
  function dcfPerShare({ fcfps, g, r, years, tg }){
    if(!Number.isFinite(fcfps) || fcfps <= 0) return NaN;
    if(!Number.isFinite(g)) return NaN;
    if(!Number.isFinite(r) || r <= 0) return NaN;
    if(!Number.isFinite(years) || years <= 0) return NaN;
    if(!Number.isFinite(tg)) return NaN;
    if(r <= tg) return NaN;

    let pv = 0;
    let fcf = fcfps;

    for(let t=1; t<=years; t++){
      fcf = fcf * (1 + g);
      pv += fcf / Math.pow(1 + r, t);
    }

    const fcfN = fcf;
    const terminal = (fcfN * (1 + tg)) / (r - tg);
    pv += terminal / Math.pow(1 + r, years);

    return pv;
  }

  function scenarioParams(base, adj){
    return {
      g: (base.g + adj.g),
      r: (base.r + adj.r),
      tg: (base.tg + adj.tg),
    };
  }

  function classifyUpside(up){
    if(!Number.isFinite(up)) return { cls:"neu", label:"‚Äî" };
    if(up >= 10) return { cls:"ok", label:"Podhodnocen√°" };
    if(up <= -10) return { cls:"bad", label:"Nadhodnocen√°" };
    return { cls:"neu", label:"Sp√≠≈° f√©rov√°" };
  }

  function buildResultRow(name, value, price){
    const diffPct = (Number.isFinite(value) && Number.isFinite(price) && price > 0)
      ? ((value / price) - 1) * 100
      : NaN;

    const c = classifyUpside(diffPct);

    return `
      <tr>
        <td><span class="pill">${name}</span></td>
        <td><b>${fmtMoney(value)}</b></td>
        <td>
          <span class="pill ${c.cls}">${c.label} ‚Ä¢ ${fmtPct(diffPct)}</span>
        </td>
      </tr>
    `;
  }

  function getAnalyzerState(){
    const ticker = $("#a_ticker").value.trim();
    const price = parseNum($("#a_price").value);

    const fcfps = parseNum($("#a_fcfps").value);

    const years = Math.round(parseNum($("#a_years").value));
    const g = parseNum($("#a_g").value) / 100;
    const r = parseNum($("#a_r").value) / 100;
    const tg = parseNum($("#a_tg").value) / 100;

    const bear_g = parseNum($("#a_bear_g").value) / 100;
    const bear_r = parseNum($("#a_bear_r").value) / 100;
    const bear_tg = parseNum($("#a_bear_tg").value) / 100;

    const bull_g = parseNum($("#a_bull_g").value) / 100;
    const bull_r = parseNum($("#a_bull_r").value) / 100;
    const bull_tg = parseNum($("#a_bull_tg").value) / 100;

    return {
      ticker,
      price,
      fcfps,
      years,
      base: { g, r, tg },
      adj: {
        bear: { g: bear_g, r: bear_r, tg: bear_tg },
        bull: { g: bull_g, r: bull_r, tg: bull_tg },
      }
    };
  }

  function validateAnalyzer(st){
    if(!Number.isFinite(st.price) || st.price <= 0) return "Vypl≈à aktu√°ln√≠ cenu (vƒõt≈°√≠ ne≈æ 0).";
    if(!Number.isFinite(st.fcfps) || st.fcfps <= 0) return "Vypl≈à FCF na akcii (vƒõt≈°√≠ ne≈æ 0).";
    if(!Number.isFinite(st.years) || st.years <= 0) return "Vypl≈à poƒçet let projekce (nap≈ô. 10).";

    if(!Number.isFinite(st.base.g)) return "Vypl≈à r≈Øst (Base) %.";
    if(!Number.isFinite(st.base.r) || st.base.r <= 0) return "Vypl≈à diskont (Base) % (vƒõt≈°√≠ ne≈æ 0).";
    if(!Number.isFinite(st.base.tg)) return "Vypl≈à termin√°ln√≠ r≈Øst (Base) %.";

    const baseOk = st.base.r > st.base.tg;
    const bear = scenarioParams(st.base, st.adj.bear);
    const bull = scenarioParams(st.base, st.adj.bull);
    if(!(baseOk && bear.r > bear.tg && bull.r > bull.tg)){
      return "Pro termin√°l mus√≠ platit r > g (diskont mus√≠ b√Ωt vƒõt≈°√≠ ne≈æ termin√°ln√≠ r≈Øst) ve v≈°ech sc√©n√°≈ô√≠ch.";
    }
    return "";
  }

  function calcAndRender(){
    const st = getAnalyzerState();
    const err = validateAnalyzer(st);
    if(err){
      setMsg("#calcMsg", err);
      $("#resultBox").style.display = "none";
      return null;
    }

    const bearP = scenarioParams(st.base, st.adj.bear);
    const bullP = scenarioParams(st.base, st.adj.bull);

    const baseVal = dcfPerShare({ fcfps: st.fcfps, g: st.base.g, r: st.base.r, years: st.years, tg: st.base.tg });
    const bearVal = dcfPerShare({ fcfps: st.fcfps, g: bearP.g, r: bearP.r, years: st.years, tg: bearP.tg });
    const bullVal = dcfPerShare({ fcfps: st.fcfps, g: bullP.g, r: bullP.r, years: st.years, tg: bullP.tg });

    const rows =
      buildResultRow("Bear", bearVal, st.price) +
      buildResultRow("Base", baseVal, st.price) +
      buildResultRow("Bull", bullVal, st.price);

    $("#resultRows").innerHTML = rows;

    const name = st.ticker ? st.ticker.toUpperCase() : "Bez tickeru";
    $("#resultMeta").textContent = `${name} ‚Ä¢ Cena: ${fmtMoney(st.price)} ‚Ä¢ Projekce: ${st.years} let`;

    const baseUp = (Number.isFinite(baseVal) && st.price > 0) ? ((baseVal / st.price) - 1) * 100 : NaN;
    const c = classifyUpside(baseUp);
    $("#resultBadge").textContent = `${c.label}`;

    $("#resultBox").style.display = "block";
    setMsg("#calcMsg", "Hotovo. V√Ωsledky jsou n√≠≈æe.");
    return { ...st, values: { bear: bearVal, base: baseVal, bull: bullVal } };
  }

  $("#btnCalc")?.addEventListener("click", () => calcAndRender());

  $("#btnResetA")?.addEventListener("click", () => {
    [
      "#a_ticker","#a_price","#a_fcfps","#a_years","#a_g","#a_r","#a_tg",
      "#a_bear_g","#a_bear_r","#a_bear_tg","#a_bull_g","#a_bull_r","#a_bull_tg","#a_shares"
    ].forEach(id => { const el = $(id); if(el) el.value = ""; });
    if($("#resultBox")) $("#resultBox").style.display = "none";
    setMsg("#calcMsg","");
  });

  // ===== Watchlist (localStorage) =====
  const WL_KEY = "equity_watchlist_v1";

  function loadWL(){
    try{
      const raw = localStorage.getItem(WL_KEY);
      const arr = raw ? JSON.parse(raw) : [];
      return Array.isArray(arr) ? arr : [];
    }catch(e){
      return [];
    }
  }
  function saveWL(arr){
    localStorage.setItem(WL_KEY, JSON.stringify(arr));
  }

  function saveCurrentToWatchlist(){
    const out = calcAndRender();
    if(!out) return;

    const now = new Date();
    const item = {
      id: String(now.getTime()) + "_" + Math.random().toString(16).slice(2),
      ts: now.toISOString(),
      ticker: out.ticker,
      price: out.price,
      fcfps: out.fcfps,
      years: out.years,
      base: out.base,
      adj: out.adj,
      values: out.values
    };

    const wl = loadWL();
    wl.unshift(item);
    saveWL(wl);
    setMsg("#calcMsg","Ulo≈æeno do watchlistu.");
  }

  $("#btnSave")?.addEventListener("click", saveCurrentToWatchlist);

  function renderWatchlist(){
    const wl = loadWL();
    const list = $("#wlList");
    if(!list) return;
    list.innerHTML = "";

    if(!wl.length){
      setMsg("#wlMsg","Watchlist je pr√°zdn√Ω.");
      return;
    }
    setMsg("#wlMsg", `Polo≈æek: ${wl.length}`);

    wl.forEach(item => {
      const dt = new Date(item.ts);
      const dateStr = dt.toLocaleString("cs-CZ", { year:"numeric", month:"2-digit", day:"2-digit", hour:"2-digit", minute:"2-digit" });
      const t = item.ticker ? item.ticker.toUpperCase() : "Bez tickeru";

      const baseUp = (Number.isFinite(item.values?.base) && item.price > 0)
        ? ((item.values.base / item.price) - 1) * 100
        : NaN;
      const cls = classifyUpside(baseUp);

      const el = document.createElement("div");
      el.className = "wlItem";
      el.innerHTML = `
        <div class="wlTop">
          <div>
            <p class="wlTitle">${t}</p>
            <p class="wlMeta">
              ${dateStr}<br>
              Cena: <b>${fmtMoney(item.price)}</b> ‚Ä¢ Base: <b>${fmtMoney(item.values?.base)}</b> ‚Ä¢ ${fmtPct(baseUp)}
            </p>
            <div style="margin-top:10px;">
              <span class="pill ${cls.cls}">${cls.label}</span>
              <span class="pill">Bear ${fmtMoney(item.values?.bear)}</span>
              <span class="pill">Bull ${fmtMoney(item.values?.bull)}</span>
            </div>
          </div>

          <div class="wlBtns">
            <button class="btn" data-wl-open="${item.id}">Otev≈ô√≠t</button>
            <button class="btn danger" data-wl-del="${item.id}">Smazat</button>
          </div>
        </div>
      `;
      list.appendChild(el);
    });

    $$("[data-wl-del]").forEach(b => {
      b.addEventListener("click", () => {
        const id = b.getAttribute("data-wl-del");
        const wl2 = loadWL().filter(x => x.id !== id);
        saveWL(wl2);
        renderWatchlist();
      });
    });

    $$("[data-wl-open]").forEach(b => {
      b.addEventListener("click", () => {
        const id = b.getAttribute("data-wl-open");
        const item = loadWL().find(x => x.id === id);
        if(!item) return;

        $("#a_ticker").value = item.ticker || "";
        $("#a_price").value = String(item.price ?? "").replace(".", ",");

        $("#a_fcfps").value = String(item.fcfps ?? "").replace(".", ",");
        $("#a_years").value = String(item.years ?? "");

        $("#a_g").value = String((item.base?.g ?? 0) * 100).replace(".", ",");
        $("#a_r").value = String((item.base?.r ?? 0) * 100).replace(".", ",");
        $("#a_tg").value = String((item.base?.tg ?? 0) * 100).replace(".", ",");

        $("#a_bear_g").value = String((item.adj?.bear?.g ?? 0) * 100).replace(".", ",");
        $("#a_bear_r").value = String((item.adj?.bear?.r ?? 0) * 100).replace(".", ",");
        $("#a_bear_tg").value = String((item.adj?.bear?.tg ?? 0) * 100).replace(".", ",");

        $("#a_bull_g").value = String((item.adj?.bull?.g ?? 0) * 100).replace(".", ",");
        $("#a_bull_r").value = String((item.adj?.bull?.r ?? 0) * 100).replace(".", ",");
        $("#a_bull_tg").value = String((item.adj?.bull?.tg ?? 0) * 100).replace(".", ",");

        showScreen("analyzer");
        calcAndRender();
      });
    });
  }

  $("#btnClearAll")?.addEventListener("click", () => {
    const ok = confirm("Opravdu smazat cel√Ω watchlist?");
    if(!ok) return;
    saveWL([]);
    renderWatchlist();
  });

  // ===== Compound Interest Calculator =====
  function futureValueWithMonthly(P0, PMT, annualRate, years){
    const r = annualRate / 12;
    const n = Math.round(years * 12);
    if(n <= 0) return NaN;
    if(!Number.isFinite(r)) return NaN;

    if(Math.abs(r) < 1e-12){
      return P0 + PMT * n;
    }
    const f = Math.pow(1 + r, n);
    return P0 * f + PMT * ((f - 1) / r);
  }

  function requiredMonthlyForTarget(P0, target, annualRate, years){
    const r = annualRate / 12;
    const n = Math.round(years * 12);
    if(n <= 0) return NaN;

    if(Math.abs(r) < 1e-12){
      return (target - P0) / n;
    }
    const f = Math.pow(1 + r, n);
    return (target - P0 * f) / ((f - 1) / r);
  }

  $("#btnCalcCI")?.addEventListener("click", () => {
    const P0 = parseNum($("#c_start").value);
    const PMT = parseNum($("#c_monthly").value);
    const rate = parseNum($("#c_rate").value) / 100;
    const years = parseNum($("#c_years").value);
    const target = parseNum($("#c_target").value);

    if(!Number.isFinite(P0) || P0 < 0) return setMsg("#ciMsg","Vypl≈à poƒç√°teƒçn√≠ vklad (0 nebo v√≠c).");
    if(!Number.isFinite(PMT) || PMT < 0) return setMsg("#ciMsg","Vypl≈à mƒõs√≠ƒçn√≠ vklad (0 nebo v√≠c).");
    if(!Number.isFinite(rate) || rate < 0) return setMsg("#ciMsg","Vypl≈à roƒçn√≠ zhodnocen√≠ % (0 nebo v√≠c).");
    if(!Number.isFinite(years) || years <= 0) return setMsg("#ciMsg","Vypl≈à poƒçet let (nap≈ô. 20).");

    const fv = futureValueWithMonthly(P0, PMT, rate, years);
    const invested = P0 + PMT * Math.round(years * 12);
    const gain = fv - invested;

    const rows = [];
    rows.push(["Budouc√≠ hodnota", fmtMoney(fv)]);
    rows.push(["Celkem vlo≈æeno", fmtMoney(invested)]);
    rows.push(["Zhodnocen√≠", fmtMoney(gain)]);

    if(Number.isFinite(target) && target > 0){
      const needMonthly = requiredMonthlyForTarget(P0, target, rate, years);
      rows.push(["Pot≈ôebn√Ω mƒõs√≠ƒçn√≠ vklad", Number.isFinite(needMonthly) ? fmtMoney(needMonthly) : "‚Äî"]);
    }

    $("#ciRows").innerHTML = rows.map(r => `<tr><td>${r[0]}</td><td><b>${r[1]}</b></td></tr>`).join("");
    $("#ciKpi").textContent = `Roky: ${years} ‚Ä¢ Roƒçn√≠ v√Ωnos: ${(rate*100).toLocaleString("cs-CZ",{maximumFractionDigits:2})}%`;
    $("#ciResult").style.display = "block";
    setMsg("#ciMsg","Hotovo. V√Ωsledek je n√≠≈æe.");
  });

  $("#btnResetCI")?.addEventListener("click", () => {
    ["#c_start","#c_monthly","#c_rate","#c_years","#c_target","#c_note"].forEach(id => $(id).value = "");
    $("#ciResult").style.display = "none";
    setMsg("#ciMsg","");
  });

  // ===== START APP =====
  showScreen("home");
</script>
</body>
  </html>




    


      

  

    

          
    

    

    
    


    





    

    

  
        

    
    

  

  





