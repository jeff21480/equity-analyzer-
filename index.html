  <!doctype html>
<html lang="cs">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Anal√Ωza akci√≠ ‚Äì MVP</title>
  <meta name="description" content="V√Ωpoƒçet vnit≈ôn√≠ hodnoty (DCF), slo≈æen√© √∫roƒçen√≠, watchlist a metodika." />
  <style>
    :root{
      --bg1:#2b1f5a;
      --bg2:#1a2342;

      --card:rgba(255,255,255,.08);
      --card2:rgba(255,255,255,.06);
      --stroke:rgba(255,255,255,.14);
      --stroke2:rgba(255,255,255,.10);

      --text:rgba(255,255,255,.92);
      --muted:rgba(255,255,255,.66);

      --accent:#8b5cf6;        /* fialov√° */
      --accent2:#a78bfa;
      --good:#22c55e;
      --bad:#ef4444;

      --shadow: 0 16px 40px rgba(0,0,0,.35);
      --radius: 20px;
      --radius2: 26px;

      --mono: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono","Courier New", monospace;
      --sans: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji","Segoe UI Emoji";
      --serif: ui-serif, Georgia, "Times New Roman", Times, serif;
    }

    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      color:var(--text);
      font-family:var(--sans);
      background:
        radial-gradient(1200px 700px at 20% 10%, rgba(139,92,246,.45), transparent 55%),
        radial-gradient(1000px 600px at 90% 30%, rgba(167,139,250,.30), transparent 55%),
        linear-gradient(160deg, var(--bg1), var(--bg2));
      min-height:100vh;
    }

    a{color:var(--accent2); text-decoration:none}
    a:hover{text-decoration:underline}

    .app{
      max-width: 980px;
      margin: 0 auto;
      padding: 18px 14px 60px;
    }

    .topbar{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:12px;
      padding: 10px 2px 14px;
    }

    .pill{
      display:inline-flex;
      align-items:center;
      gap:10px;
      padding: 10px 14px;
      border:1px solid var(--stroke);
      background: rgba(255,255,255,.06);
      border-radius: 999px;
      backdrop-filter: blur(8px);
      box-shadow: 0 10px 28px rgba(0,0,0,.18);
      user-select:none;
      white-space:nowrap;
    }

    .dot{
      width:10px; height:10px;
      border-radius:999px;
      background: linear-gradient(180deg, #60a5fa, #a78bfa);
      box-shadow: 0 0 0 4px rgba(167,139,250,.18);
    }

    .badge{
      opacity:.85;
      font-weight:700;
      letter-spacing:.08em;
      font-size:12px;
      padding: 8px 12px;
      border-radius:999px;
      border:1px solid var(--stroke);
      background: rgba(255,255,255,.05);
    }

    header.hero{
      padding: 8px 2px 16px;
    }

    h1{
      margin: 8px 0 6px;
      font-family: var(--serif);
      font-weight: 800;
      letter-spacing: .01em;
      font-size: clamp(40px, 7vw, 64px);
      line-height:1.02;
      text-shadow: 0 18px 40px rgba(0,0,0,.30);
    }

    .sub{
      margin:0;
      color:var(--muted);
      max-width: 62ch;
      font-size: 16px;
      line-height: 1.6;
    }

    .menu{
      margin-top: 18px;
      display:flex;
      flex-direction:column;
      gap: 14px;
    }

    .tile{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:12px;
      padding: 18px 16px;
      border-radius: var(--radius2);
      border: 1px solid var(--stroke);
      background: linear-gradient(180deg, rgba(255,255,255,.09), rgba(255,255,255,.05));
      box-shadow: var(--shadow);
      cursor:pointer;
      transition: transform .12s ease, border-color .12s ease;
    }
    .tile:active{transform: translateY(1px)}
    .tile:hover{border-color: rgba(167,139,250,.35)}
    .tile .left{
      display:flex; align-items:center; gap:14px;
      min-width:0;
    }
    .icon{
      width:46px; height:46px;
      border-radius: 16px;
      background: rgba(255,255,255,.08);
      border:1px solid var(--stroke2);
      display:grid; place-items:center;
      flex:0 0 auto;
      box-shadow: 0 10px 22px rgba(0,0,0,.22);
      overflow:hidden;
    }
    .icon span{
      font-size:22px;
      filter: drop-shadow(0 8px 10px rgba(0,0,0,.35));
    }
    .tile h3{
      margin:0;
      font-family: var(--serif);
      font-weight: 800;
      font-size: 28px;
      line-height: 1.1;
    }
    .tile p{
      margin: 4px 0 0;
      color: var(--muted);
      font-size: 14px;
      line-height: 1.4;
      max-width: 46ch;
    }
    .chev{
      opacity:.75;
      font-size: 22px;
      padding-right: 4px;
    }

    .screen{
      display:none;
      padding-top: 8px;
    }
    .screen.active{display:block;}

    .backRow{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:12px;
      margin: 2px 0 14px;
    }
    .btn{
      border:1px solid var(--stroke);
      background: rgba(255,255,255,.06);
      color: var(--text);
      border-radius: 999px;
      padding: 10px 14px;
      cursor:pointer;
      backdrop-filter: blur(10px);
      transition: border-color .12s ease, transform .12s ease, background .12s ease;
      font-weight: 700;
      letter-spacing:.01em;
    }
    .btn:hover{border-color: rgba(167,139,250,.38)}
    .btn:active{transform: translateY(1px)}
    .btnPrimary{
      border-color: rgba(139,92,246,.55);
      background: linear-gradient(180deg, rgba(139,92,246,.85), rgba(139,92,246,.55));
    }
    .btnPrimary:hover{border-color: rgba(167,139,250,.70)}
    .btnGhost{
      background: rgba(255,255,255,.04);
    }
    .btnDanger{
      border-color: rgba(239,68,68,.55);
      background: rgba(239,68,68,.14);
    }

    .titleWrap{
      display:flex;
      align-items:baseline;
      justify-content:space-between;
      gap:12px;
      margin-bottom: 6px;
    }
    .screenTitle{
      margin: 0;
      font-family: var(--serif);
      font-weight: 900;
      letter-spacing: .01em;
      font-size: 34px;
      line-height:1.12;
    }
    .screenSub{
      margin: 0 0 14px;
      color: var(--muted);
      font-size: 14px;
      line-height:1.55;
    }

    .card{
      border:1px solid var(--stroke);
      background: linear-gradient(180deg, rgba(255,255,255,.08), rgba(255,255,255,.05));
      border-radius: var(--radius2);
      box-shadow: var(--shadow);
      padding: 16px;
    }
    .card + .card{margin-top: 14px}

    .panelTitle{
      margin: 0 0 6px;
      font-weight: 900;
      letter-spacing: .01em;
      font-size: 18px;
    }
    .subTitle{
      margin: 0 0 12px;
      color: var(--muted);
      font-size: 13px;
      line-height:1.55;
    }
    .divider{
      height:1px;
      background: rgba(255,255,255,.10);
      margin: 12px 0;
    }

    .grid{
      display:grid;
      grid-template-columns: 1fr;
      gap: 12px;
    }
    .grid.two{grid-template-columns: repeat(2, minmax(0,1fr));}
    .grid.three{grid-template-columns: repeat(3, minmax(0,1fr));}
    @media (max-width: 720px){
      .grid.two, .grid.three{grid-template-columns: 1fr;}
      .tile h3{font-size:26px}
    }

    label{
      display:block;
      font-size: 13px;
      color: rgba(255,255,255,.78);
      margin: 0 0 6px;
      font-weight: 700;
    }
    input, select{
      width:100%;
      border-radius: 14px;
      border:1px solid rgba(255,255,255,.14);
      background: rgba(0,0,0,.18);
      color: var(--text);
      padding: 12px 12px;
      font-size: 16px;
      outline: none;
    }
    input:focus, select:focus{
      border-color: rgba(167,139,250,.6);
      box-shadow: 0 0 0 4px rgba(167,139,250,.18);
    }
    .small{
      color: var(--muted);
      font-size: 13px;
      line-height: 1.5;
    }

    details{
      border:1px solid rgba(255,255,255,.12);
      background: rgba(255,255,255,.04);
      border-radius: 14px;
      padding: 10px 12px;
    }
    details summary{
      cursor:pointer;
      color: rgba(255,255,255,.86);
      font-weight: 800;
      list-style:none;
    }
    details summary::-webkit-details-marker{display:none}
    details .content{
      margin-top: 8px;
      color: var(--muted);
      font-size: 13px;
      line-height: 1.55;
    }

    .btns{
      display:flex;
      flex-wrap:wrap;
      gap:10px;
      margin-top: 12px;
    }

    .resultBox{
      margin-top: 14px;
      border-radius: var(--radius2);
      border: 1px solid rgba(255,255,255,.16);
      background: linear-gradient(180deg, rgba(0,0,0,.14), rgba(0,0,0,.10));
      padding: 14px;
    }
    .resultTop{
      display:flex;
      align-items:flex-start;
      justify-content:space-between;
      gap:12px;
    }
    .resultTop h4{
      margin:0;
      font-size: 16px;
      font-weight: 900;
      letter-spacing:.01em;
    }
    .resultTop .muted{
      margin: 4px 0 0;
      color: var(--muted);
      font-size: 13px;
    }
    .kpi{
      font-family: var(--mono);
      font-size: 14px;
      opacity: .92;
    }

    table{
      width:100%;
      border-collapse: collapse;
      margin-top: 10px;
      overflow:hidden;
      border-radius: 14px;
    }
    th, td{
      padding: 10px 10px;
      border-bottom: 1px solid rgba(255,255,255,.10);
      text-align:left;
      font-size: 14px;
    }
    th{
      color: rgba(255,255,255,.78);
      font-size: 12px;
      letter-spacing: .08em;
      text-transform: uppercase;
      font-weight: 900;
    }
    tr:last-child td{border-bottom:none}

    .pillMini{
      display:inline-flex;
      align-items:center;
      gap:8px;
      padding: 6px 10px;
      border-radius: 999px;
      border: 1px solid rgba(255,255,255,.14);
      background: rgba(255,255,255,.05);
      font-size: 12px;
      color: rgba(255,255,255,.78);
      white-space:nowrap;
    }

    .pct.good{color: var(--good); font-weight: 900;}
    .pct.bad{color: var(--bad); font-weight: 900;}
    .pct.neu{color: rgba(255,255,255,.82); font-weight: 900;}

    .rowActions{
      display:flex;
      gap:8px;
      justify-content:flex-end;
    }
    .openBtn{
      border:1px solid rgba(167,139,250,.45);
      background: rgba(139,92,246,.18);
      color: var(--text);
      border-radius: 999px;
      padding: 8px 10px;
      cursor:pointer;
      font-weight: 800;
    }
    .trash{
      border:1px solid rgba(239,68,68,.55);
      background: rgba(239,68,68,.16);
      color: var(--text);
      border-radius: 999px;
      padding: 8px 10px;
      cursor:pointer;
      font-weight: 800;
    }

    .footer{
      margin-top: 18px;
      padding: 12px 2px 0;
      color: rgba(255,255,255,.55);
      font-size: 12px;
      line-height:1.5;
    }

    .toast{
      margin-top: 10px;
      color: rgba(255,255,255,.78);
      font-size: 13px;
      min-height: 18px;
    }
  </style>
</head>

<body>
  <div class="app">

    <!-- HOME -->
    <section id="screen-home" class="screen active">
      <div class="topbar">
        <div class="pill"><span class="dot"></span> Anal√Ωza akci√≠ ‚Ä¢ <span style="opacity:.9;font-weight:800">Beta</span></div>
        <div class="badge">MVP</div>
      </div>

      <header class="hero">
        <h1>Anal√Ωza akci√≠</h1>
        <p class="sub">
          Modern√≠ n√°stroje pro investory: v√Ωpoƒçet vnit≈ôn√≠ hodnoty (DCF),
          watchlist, slo≈æen√© √∫roƒçen√≠ a srozumiteln√© vysvƒõtlen√≠ metodiky.
        </p>

        <div class="menu">
          <div class="tile" data-open="analyzer">
            <div class="left">
              <div class="icon"><span>üìà</span></div>
              <div style="min-width:0">
                <h3>Analyz√°tor</h3>
                <p>Odhad vnit≈ôn√≠ hodnoty (Bear / Base / Bull) + pod/nadhodnocen√≠ v %</p>
              </div>
            </div>
            <div class="chev">‚Ä∫</div>
          </div>

          <div class="tile" data-open="calc">
            <div class="left">
              <div class="icon"><span>üßÆ</span></div>
              <div style="min-width:0">
                <h3>Kalkulaƒçka</h3>
                <p>Slo≈æen√© √∫roƒçen√≠ + c√≠lov√° ƒç√°stka (kolik mus√≠≈° mƒõs√≠ƒçnƒõ odkl√°dat)</p>
              </div>
            </div>
            <div class="chev">‚Ä∫</div>
          </div>

          <div class="tile" data-open="watchlist">
            <div class="left">
              <div class="icon"><span>üëÄ</span></div>
              <div style="min-width:0">
                <h3>Watchlist</h3>
                <p>Ulo≈æen√© anal√Ωzy (datum + v√Ωsledky). Otev≈ôen√≠ zpƒõt do analyz√°toru.</p>
              </div>
            </div>
            <div class="chev">‚Ä∫</div>
          </div>

          <div class="tile" data-open="how">
            <div class="left">
              <div class="icon"><span>‚ÑπÔ∏è</span></div>
              <div style="min-width:0">
                <h3>Jak to funguje</h3>
                <p>Pro koho je aplikace, proƒç existuje a jakou metodikou poƒç√≠t√°.</p>
              </div>
            </div>
            <div class="chev">‚Ä∫</div>
          </div>
        </div>

        <div class="footer">
          <div>¬© Anal√Ωza akci√≠ ‚Äì MVP. V≈°echny v√Ωpoƒçty jsou orientaƒçn√≠.</div>
          <div><a href="https://www.hradeckesluzby.cz" target="_blank" rel="noopener">www.hradeckesluzby.cz</a></div>
        </div>
      </header>
    </section>

    <!-- ANALYZER -->
    <section id="screen-analyzer" class="screen">
      <div class="backRow">
        <button class="btn btnGhost" data-back="home">‚Üê Zpƒõt</button>
        <div class="badge">Beta</div>
      </div>

      <div class="titleWrap">
        <h2 class="screenTitle">Analyz√°tor</h2>
        <span class="pillMini">DCF ‚Ä¢ 3 sc√©n√°≈ôe</span>
      </div>
      <p class="screenSub">Zadej sv√© p≈ôedpoklady. V√Ωsledek uvid√≠≈° pro Bear / Base / Bull v jednom r√°meƒçku.</p>

      <div class="card">
        <div class="panelTitle">Z√°kladn√≠ vstupy</div>
        <div class="subTitle">Pracujeme se zjednodu≈°en√Ωm DCF na √∫rovni <b>FCF na akcii</b>.</div>

        <div class="grid two">
          <div>
            <label for="a_ticker">Ticker (voliteln√©)</label>
            <input id="a_ticker" type="text" placeholder="nap≈ô. SOFI" autocomplete="off" />
          </div>
          <div>
            <label for="a_price">Aktu√°ln√≠ cena akcie</label>
            <input id="a_price" type="text" inputmode="decimal" placeholder="nap≈ô. 9,50" />
          </div>
        </div>

        <div class="grid two" style="margin-top:12px">
          <div>
            <label for="a_fcfps">FCF na akcii (aktu√°lnƒõ)</label>
            <input id="a_fcfps" type="text" inputmode="decimal" placeholder="nap≈ô. 0,35" />
          </div>
          <div>
            <label for="a_years">Poƒçet let projekce</label>
            <input id="a_years" type="text" inputmode="numeric" placeholder="nap≈ô. 10" />
          </div>
        </div>

        <div class="divider"></div>

        <div class="grid three">
          <div>
            <label for="a_g">R≈Øst (Base) %</label>
            <input id="a_g" type="text" inputmode="decimal" placeholder="nap≈ô. 8" />
            <details style="margin-top:10px">
              <summary>Co to je?</summary>
              <div class="content">
                Pr≈Ømƒõrn√Ω meziroƒçn√≠ r≈Øst FCF na akcii v projekƒçn√≠m obdob√≠.
                <br><br>
                <b>Tip:</b> m≈Ø≈æe≈° ps√°t desetinnou ƒç√°rkou (nap≈ô. 9,5).
              </div>
            </details>
          </div>

          <div>
            <label for="a_r">Diskont (Base) %</label>
            <input id="a_r" type="text" inputmode="decimal" placeholder="nap≈ô. 9" />
            <details style="margin-top:10px">
              <summary>Co to je?</summary>
              <div class="content">
                Diskontn√≠ sazba vyjad≈ôuje po≈æadovan√Ω v√Ωnos (rizikovost).
                ƒå√≠m vy≈°≈°√≠ diskont, t√≠m ni≈æ≈°√≠ dne≈°n√≠ hodnota budouc√≠ch cash flow.
              </div>
            </details>
          </div>

          <div>
            <label for="a_tg">Termin√°ln√≠ r≈Øst (Base) %</label>
            <input id="a_tg" type="text" inputmode="decimal" placeholder="nap≈ô. 2,5" />
            <details style="margin-top:10px">
              <summary>Co to je?</summary>
              <div class="content">
                Dlouhodob√Ω r≈Øst po skonƒçen√≠ projekƒçn√≠ho obdob√≠.
                Obvykle se dr≈æ√≠ realisticky (ƒçasto 2‚Äì4 %).
              </div>
            </details>
          </div>
        </div>

        <div class="divider"></div>

        <div class="panelTitle">Sc√©n√°≈ôe (√∫pravy v≈Øƒçi Base)</div>
        <div class="subTitle">
          √öpravy jsou v <b>procentn√≠ch bodech</b> (p.b.). Nap≈ô. +2 p.b. r≈Østu znamen√°:
          Base r≈Øst 8 % ‚Üí Bull r≈Øst 10 %.
        </div>

        <div class="grid three">
          <div>
            <label for="a_bear_g">Bear √∫prava r≈Østu (p.b.)</label>
            <input id="a_bear_g" type="text" inputmode="decimal" value="-2" />
          </div>
          <div>
            <label for="a_bear_r">Bear √∫prava diskontu (p.b.)</label>
            <input id="a_bear_r" type="text" inputmode="decimal" value="+1" />
          </div>
          <div>
            <label for="a_bear_tg">Bear √∫prava termin√°lu (p.b.)</label>
            <input id="a_bear_tg" type="text" inputmode="decimal" value="-0,5" />
          </div>

          <div>
            <label for="a_bull_g">Bull √∫prava r≈Østu (p.b.)</label>
            <input id="a_bull_g" type="text" inputmode="decimal" value="+2" />
          </div>
          <div>
            <label for="a_bull_r">Bull √∫prava diskontu (p.b.)</label>
            <input id="a_bull_r" type="text" inputmode="decimal" value="-1" />
          </div>
          <div>
            <label for="a_bull_tg">Bull √∫prava termin√°lu (p.b.)</label>
            <input id="a_bull_tg" type="text" inputmode="decimal" value="+0,5" />
          </div>
        </div>

        <div class="btns">
          <button id="btnCalc" class="btn btnPrimary">Spoƒç√≠tat</button>
          <button id="btnSave" class="btn">Ulo≈æit do Watchlistu</button>
        </div>

        <div id="calcMsg" class="toast"></div>

        <div id="resultBox" class="resultBox" style="display:none">
          <div class="resultTop">
            <div>
              <h4>V√Ωsledek (vnit≈ôn√≠ hodnota na akcii)</h4>
              <div class="muted">Bear / Base / Bull + pod/nadhodnocen√≠ v≈Øƒçi aktu√°ln√≠ cenƒõ.</div>
            </div>
            <div class="kpi" id="kpiLine"></div>
          </div>

          <table>
            <thead>
              <tr>
                <th>Sc√©n√°≈ô</th>
                <th>Odhad f√©rov√© ceny</th>
                <th>Rozd√≠l vs. cena</th>
              </tr>
            </thead>
            <tbody id="resBody"></tbody>
          </table>

          <div class="small" style="margin-top:10px">
            Pozn√°mka: jde o zjednodu≈°en√Ω model. P≈ôesnost z√°vis√≠ na vstupn√≠ch p≈ôedpokladech.
          </div>
        </div>
      </div>
    </section>

    <!-- CALCULATOR -->
    <section id="screen-calc" class="screen">
      <div class="backRow">
        <button class="btn btnGhost" data-back="home">‚Üê Zpƒõt</button>
        <div class="badge">Beta</div>
      </div>

      <div class="titleWrap">
        <h2 class="screenTitle">Kalkulaƒçka</h2>
        <span class="pillMini">Slo≈æen√© √∫roƒçen√≠</span>
      </div>
      <p class="screenSub">V√Ωpoƒçet budouc√≠ hodnoty investice (poƒç√°teƒçn√≠ vklad + pravideln√© vklady).</p>

      <div class="card">
        <div class="panelTitle">Vstupy</div>
        <div class="subTitle">M≈Ø≈æe≈° ps√°t desetinnou ƒç√°rkou (nap≈ô. 7,5).</div>

        <div class="grid two">
          <div>
            <label for="c_start">Poƒç√°teƒçn√≠ vklad</label>
            <input id="c_start" type="text" inputmode="decimal" placeholder="nap≈ô. 100 000" />
          </div>
          <div>
            <label for="c_monthly">Mƒõs√≠ƒçn√≠ vklad</label>
            <input id="c_monthly" type="text" inputmode="decimal" placeholder="nap≈ô. 2 000" />
          </div>
        </div>

        <div class="grid two" style="margin-top:12px">
          <div>
            <label for="c_rate">Roƒçn√≠ zhodnocen√≠ %</label>
            <input id="c_rate" type="text" inputmode="decimal" placeholder="nap≈ô. 7" />
          </div>
          <div>
      <div>
            <label for="c_years">Doba (roky)</label>
            <input id="c_years" type="text" inputmode="numeric" placeholder="nap≈ô. 15" />
          </div>
        </div>

        <div class="divider"></div>

        <div class="panelTitle">C√≠l (voliteln√©)</div>
        <div class="subTitle">Pokud zad√°≈° c√≠lovou ƒç√°stku, spoƒç√≠t√°me orientaƒçn√≠ pot≈ôebn√Ω mƒõs√≠ƒçn√≠ vklad.</div>

        <div class="grid two">
          <div>
            <label for="c_target">C√≠lov√° ƒç√°stka</label>
            <input id="c_target" type="text" inputmode="decimal" placeholder="nap≈ô. 1 000 000" />
          </div>
          <div>
            <label for="c_note">Pozn√°mka (voliteln√©)</label>
            <input id="c_note" type="text" placeholder="nap≈ô. pro d√≠tƒõ / d≈Øchod" />
          </div>
        </div>

        <div class="btns">
          <button id="btnCalcCI" class="btn btnPrimary">Spoƒç√≠tat</button>
          <button id="btnResetCI" class="btn btnGhost">Vymazat</button>
        </div>

        <div id="ciMsg" class="toast"></div>

        <div id="ciResult" class="resultBox" style="display:none">
          <div class="resultTop">
            <div>
              <h4>V√Ωsledek</h4>
              <div class="muted">Budouc√≠ hodnota + souhrn vklad≈Ø.</div>
            </div>
            <div class="kpi" id="ciKpi"></div>
          </div>

          <table>
            <tbody id="ciBody"></tbody>
          </table>

          <div class="small" style="margin-top:10px">
            V√Ωpoƒçet je orientaƒçn√≠. Nezahrnuje danƒõ, poplatky ani inflaci.
          </div>
        </div>
      </div>
    </section>

    <!-- WATCHLIST -->
    <section id="screen-watchlist" class="screen">
      <div class="backRow">
        <button class="btn btnGhost" data-back="home">‚Üê Zpƒõt</button>
        <div class="badge">MVP</div>
      </div>

      <div class="titleWrap">
        <h2 class="screenTitle">Watchlist</h2>
        <span class="pillMini">Ulo≈æen√© anal√Ωzy</span>
      </div>
      <p class="screenSub">Ka≈ædou polo≈æku m≈Ø≈æe≈° smazat zvl√°≈°≈•. ‚ÄûSmazat v≈°e‚Äú sma≈æe cel√Ω watchlist.</p>

      <div class="card">
        <div class="panelTitle">Ulo≈æen√© polo≈æky</div>
        <div class="subTitle">Otev≈ôen√≠ naƒçte hodnoty zpƒõt do analyz√°toru (potom klikni ‚ÄûSpoƒç√≠tat‚Äú).</div>

        <div class="btns">
          <button id="btnClearAll" class="btn btnDanger">Smazat v≈°e</button>
          <button id="btnExport" class="btn">Export CSV</button>
        </div>

        <div id="wlMsg" class="toast"></div>

        <div class="resultBox" style="margin-top:12px">
          <table>
            <thead>
              <tr>
                <th>Datum</th>
                <th>Ticker</th>
                <th>Base cena</th>
                <th>Upside %</th>
                <th style="text-align:right">Akce</th>
              </tr>
            </thead>
            <tbody id="wlBody"></tbody>
          </table>

          <div class="small" style="margin-top:10px">
            Tip: CSV export je v UTF-8 s BOM (Excel-friendly).
          </div>
        </div>
      </div>
    </section>

    <!-- HOW -->
    <section id="screen-how" class="screen">
      <div class="backRow">
        <button class="btn btnGhost" data-back="home">‚Üê Zpƒõt</button>
        <div class="badge">Beta</div>
      </div>

      <div class="titleWrap">
        <h2 class="screenTitle">Jak to funguje</h2>
        <span class="pillMini">Metodika ‚Ä¢ vysvƒõtlen√≠</span>
      </div>
      <p class="screenSub">Struƒçnƒõ a srozumitelnƒõ: proƒç aplikace existuje, pro koho je a co p≈ôesnƒõ dƒõl√°.</p>

      <div class="card">
        <div class="panelTitle">Jak to funguje a proƒç tato aplikace existuje</div>
        <div class="subTitle">
          Tato aplikace vznikla jako n√°stroj pro investory, kte≈ô√≠ chtƒõj√≠ porozumƒõt hodnotƒõ firmy
          a pracovat s vlastn√≠mi p≈ôedpoklady.
        </div>

        <div class="small" style="font-size:14px; line-height:1.7; color:rgba(255,255,255,.78)">
          <p style="margin-top:0">
            Jej√≠m c√≠lem nen√≠ ≈ô√≠kat, jakou akcii koupit nebo prodat. C√≠lem je nab√≠dnout strukturovan√Ω
            a srozumiteln√Ω zp≈Øsob, jak si s√°m odhadnout vnit≈ôn√≠ hodnotu spoleƒçnosti a pochopit,
            z jak√Ωch p≈ôedpoklad≈Ø tento odhad vych√°z√≠.
          </p>

          <div class="divider"></div>

          <p style="margin:0 0 8px"><b>Pro koho je aplikace urƒçena</b></p>
          <ul style="margin-top:0; color:rgba(255,255,255,.72)">
            <li>dlouhodob√© investory</li>
            <li>u≈æivatele, kte≈ô√≠ chtƒõj√≠ pracovat s vlastn√≠mi vstupy</li>
            <li>investory, kte≈ô√≠ chtƒõj√≠ rozumƒõt valuaci, ne ji pouze p≈ôeb√≠rat</li>
          </ul>

          <div class="divider"></div>

          <p style="margin:0 0 8px"><b>P≈ô√≠stup bez automatick√Ωch doporuƒçen√≠</b></p>
          <p style="margin-top:0; color:rgba(255,255,255,.72)">
            Aplikace nepou≈æ√≠v√° umƒõlou inteligenci ani automatick√© predikce, kter√© by samy urƒçovaly ‚Äûspr√°vnou‚Äú cenu.
            Ka≈æd√Ω v√Ωsledek vych√°z√≠ v√Ωhradnƒõ ze vstup≈Ø, kter√© zad√°v√° u≈æivatel. D√≠ky tomu je jasn√©, co m√° na v√Ωsledek vliv
            a proƒç se mƒõn√≠.
          </p>

          <div class="divider"></div>

          <p style="margin:0 0 8px"><b>Metodika</b></p>
          <p style="margin-top:0; color:rgba(255,255,255,.72)">
            Pro ocenƒõn√≠ se pou≈æ√≠v√° metoda diskontovan√Ωch penƒõ≈æn√≠ch tok≈Ø (DCF).
            Model pracuje se t≈ôemi sc√©n√°≈ôi (Bear/Base/Bull), proto≈æe v praxi neexistuje jedin√© spr√°vn√© ƒç√≠slo,
            ale rozpƒõt√≠ mo≈æn√Ωch v√Ωsledk≈Ø.
          </p>

          <div class="divider"></div>

          <p style="margin:0 0 8px"><b>Edukaƒçn√≠ smysl</b></p>
          <p style="margin-top:0; color:rgba(255,255,255,.72)">
            Aplikace je navr≈æena tak, aby investor postupnƒõ ch√°pal vliv r≈Østu, diskontu a termin√°ln√≠ hodnoty,
            vidƒõl citlivost v√Ωsledk≈Ø a budoval vlastn√≠ investiƒçn√≠ √∫sudek.
          </p>

          <div class="divider"></div>

          <p style="margin:0 0 8px"><b>D≈Øle≈æit√© upozornƒõn√≠</b></p>
          <p style="margin-top:0; color:rgba(255,255,255,.72)">
            V√Ωsledky nep≈ôedstavuj√≠ investiƒçn√≠ doporuƒçen√≠. Jde o modelov√Ω v√Ωpoƒçet a jeho kvalita z√°vis√≠ na kvalitƒõ vstup≈Ø.
          </p>
        </div>
      </div>
    </section>

  </div>

  <script>
    // ===== Helpers =====
    const $ = (sel) => document.querySelector(sel);
    const $$ = (sel) => Array.from(document.querySelectorAll(sel));

    function showScreen(name){
      $$(".screen").forEach(s => s.classList.remove("active"));
      $("#screen-" + name).classList.add("active");
      if(name === "watchlist") renderWatchlist();
    }

    // decimal parsing: accepts "9,5" "9.5" "1 000" etc
    function parseNum(v){
      if(v == null) return NaN;
      const s = String(v)
        .trim()
        .replace(/\s+/g,"")
        .replace(",",".")
        .replace(/[^\d\.\-\+]/g,"");
      const n = Number(s);
      return Number.isFinite(n) ? n : NaN;
    }

    function fmtMoney(n){
      if(!Number.isFinite(n)) return "‚Äî";
      return n.toLocaleString("cs-CZ", {maximumFractionDigits: 2});
    }
    function fmtPct(n){
      if(!Number.isFinite(n)) return "‚Äî";
      const sign = n > 0 ? "+" : "";
      return sign + n.toLocaleString("cs-CZ", {maximumFractionDigits: 1}) + " %";
    }

    function pctClass(n){
      if(!Number.isFinite(n)) return "neu";
      if(n > 0.05) return "good";
      if(n < -0.05) return "bad";
      return "neu";
    }

    // download helper
    function downloadTextFile(filename, text, mime="text/plain;charset=utf-8"){
      const blob = new Blob([text], {type: mime});
      const url = URL.createObjectURL(blob);
      const a = document.createElement("a");
      a.href = url;
      a.download = filename;
      document.body.appendChild(a);
      a.click();
      a.remove();
      URL.revokeObjectURL(url);
    }

    // ===== Navigation =====
    $$(".tile").forEach(t => {
      t.addEventListener("click", () => showScreen(t.dataset.open));
    });
    $$("[data-back]").forEach(b => {
      b.addEventListener("click", () => showScreen(b.dataset.back));
    });

    // ===== Analyzer (DCF) =====
    function dcfPerShare(fcf0, years, g, r, tg){
      if(!(fcf0>0) || !(years>0) || !(r>0) || !(Number.isFinite(g)) || !(Number.isFinite(tg))) return NaN;
      if(r <= tg) return NaN;

      let pv = 0;
      for(let t=1; t<=years; t++){
        const f = fcf0 * Math.pow(1+g, t);
        pv += f / Math.pow(1+r, t);
      }
      const fN = fcf0 * Math.pow(1+g, years);
      const fNp1 = fN * (1+tg);
      const terminal = fNp1 / (r - tg);
      const pvTerminal = terminal / Math.pow(1+r, years);
      return pv + pvTerminal;
    }

    function computeScenario(base, adj){
      const g = base.g + adj.g;
      const r = base.r + adj.r;
      const tg = base.tg + adj.tg;
      return { g, r, tg, value: dcfPerShare(base.fcf0, base.years, g, r, tg) };
    }

    function setMsg(id, text){
      $(id).textContent = text || "";
    }

    function renderDCFResults(price, results){
      const tbody = $("#resBody");
      tbody.innerHTML = "";

      const rows = [
        {name:"Bear", v: results.bear.value},
        {name:"Base", v: results.base.value},
        {name:"Bull", v: results.bull.value},
      ];

      for(const row of rows){
        const diffPct = (Number.isFinite(price) && price > 0 && Number.isFinite(row.v))
          ? ((row.v / price) - 1) * 100
          : NaN;

        const tr = document.createElement("tr");

        const tdA = document.createElement("td");
        tdA.textContent = row.name;

        const tdB = document.createElement("td");
        tdB.innerHTML = `<span style="font-weight:900">${fmtMoney(row.v)}</span>`;

        const tdC = document.createElement("td");
        const cls = pctClass(diffPct);
        tdC.innerHTML = `<span class="pct ${cls}">${fmtPct(diffPct)}</span>`;

        tr.appendChild(tdA);
        tr.appendChild(tdB);
        tr.appendChild(tdC);
        tbody.appendChild(tr);
      }

      $("#resultBox").style.display = "block";
    }

    function readAnalyzerInputs(){
      const ticker = $("#a_ticker").value.trim().toUpperCase();
      const price = parseNum($("#a_price").value);
      const fcf0  = parseNum($("#a_fcfps").value);
      const years = Math.round(parseNum($("#a_years").value));

      const g  = parseNum($("#a_g").value) / 100;
      const r  = parseNum($("#a_r").value) / 100;
      const tg = parseNum($("#a_tg").value) / 100;

      const bearAdj = {
        g:  parseNum($("#a_bear_g").value) / 100,
        r:  parseNum($("#a_bear_r").value) / 100,
        tg: parseNum($("#a_bear_tg").value) / 100,
      };
      const bullAdj = {
        g:  parseNum($("#a_bull_g").value) / 100,
        r:  parseNum($("#a_bull_r").value) / 100,
        tg: parseNum($("#a_bull_tg").value) / 100,
      };

      return {ticker, price, fcf0, years, g, r, tg, bearAdj, bullAdj};
    }

    function validateAnalyzer(base, price){
      if(!(base.fcf0 > 0)) return "Dopl≈à FCF na akcii (kladn√© ƒç√≠slo).";
      if(!(base.years > 0)) return "Dopl≈à poƒçet let projekce (nap≈ô. 10).";
      if(!(base.r > 0)) return "Dopl≈à diskont (nap≈ô. 9).";
      if(!Number.isFinite(base.g)) return "Dopl≈à r≈Øst (Base).";
      if(!Number.isFinite(base.tg)) return "Dopl≈à termin√°ln√≠ r≈Øst (Base).";
      if(base.r <= base.tg) return "Diskont mus√≠ b√Ωt vy≈°≈°√≠ ne≈æ termin√°ln√≠ r≈Øst (r > tg).";
      if(!(price > 0)) return "Dopl≈à aktu√°ln√≠ cenu akcie (kladn√© ƒç√≠slo).";
      return "";
    }

    $("#btnCalc").addEventListener("click", () => {
      setMsg("#calcMsg","");
      $("#resultBox").style.display = "none";

      const x = readAnalyzerInputs();
      const base = { fcf0:x.fcf0, years:x.years, g:x.g, r:x.r, tg:x.tg };

      const err = validateAnalyzer(base, x.price);
      if(err){
        setMsg("#calcMsg", err);
        return;
      }

      const baseRes = computeScenario(base, {g:0,r:0,tg:0});
      const bearRes = computeScenario(base, x.bearAdj);
      const bullRes = computeScenario(base, x.bullAdj);

      const results = { bear: bearRes, base: baseRes, bull: bullRes };

      const t = x.ticker ? x.ticker : "‚Äî";
      $("#kpiLine").textContent =
        `Ticker: ${t} ‚Ä¢ Cena: ${fmtMoney(x.price)} ‚Ä¢ FCF/akcii: ${fmtMoney(x.fcf0)} ‚Ä¢ Roky: ${base.years}`;

      renderDCFResults(x.price, results);
      setMsg("#calcMsg","Hotovo. V√Ωsledek je n√≠≈æe v r√°meƒçku.");
    });

    // ===== Watchlist =====
    const WL_KEY = "equity_mvp_watchlist_v1";

    function loadWatchlist(){
      try{
        const raw = localStorage.getItem(WL_KEY);
        const arr = raw ? JSON.parse(raw) : [];
        return Array.isArray(arr) ? arr : [];
      }catch(e){
        return [];
      }
    }
    function saveWatchlist(arr){
      localStorage.setItem(WL_KEY, JSON.stringify(arr));
    }

    function computeBaseValuesForSave(){
      const x = readAnalyzerInputs();
      const base = { fcf0:x.fcf0, years:x.years, g:x.g, r:x.r, tg:x.tg };
      const err = validateAnalyzer(base, x.price);
      if(err) return {err};

      const baseRes = computeScenario(base, {g:0,r:0,tg:0});
      const bearRes = computeScenario(base, x.bearAdj);
      const bullRes = computeScenario(base, x.bullAdj);

      const upsidePct = (Number.isFinite(baseRes.value) && x.price>0) ? ((baseRes.value/x.price)-1)*100 : NaN;

      return {
        err:"",
        data:{
          id: crypto.randomUUID ? crypto.randomUUID() : String(Date.now()) + "_" + Math.random().toString(16).slice(2),
          ts: new Date().toISOString(),
          ticker: x.ticker || "",
          price: x.price,
          fcf0: x.fcf0,
          years: x.years,
          base: { g:x.g*100, r:x.r*100, tg:x.tg*100 },
          adj: {
            bear: { g:x.bearAdj.g*100, r:x.bearAdj.r*100, tg:x.bearAdj.tg*100 },
            bull: { g:x.bullAdj.g*100, r:x.bullAdj.r*100, tg:x.bullAdj.tg*100 },
          },
          values:{
            bear: bearRes.value,
            base: baseRes.value,
            bull: bullRes.value,
            upsidePct
          }
        }
      };
    }

    $("#btnSave").addEventListener("click", () => {
      setMsg("#calcMsg","");
      const res = computeBaseValuesForSave();
      if(res.err){
        setMsg("#calcMsg", res.err);
        return;
      }
      const wl = loadWatchlist();
      wl.unshift(res.data);
      saveWatchlist(wl);
      setMsg("#calcMsg","Ulo≈æeno do Watchlistu.");
    });

    function renderWatchlist(){
      const wl = loadWatchlist();
      const body = $("#wlBody");
      body.innerHTML = "";

      if(wl.length === 0){
        const tr = document.createElement("tr");
        tr.innerHTML = `<td colspan="5" style="color:rgba(255,255,255,.65)">Zat√≠m nem√°≈° ≈æ√°dn√© ulo≈æen√© polo≈æky.</td>`;
        body.appendChild(tr);
        return;
      }

      for(const item of wl){
        const d = new Date(item.ts);
        const date = d.toLocaleDateString("cs-CZ") + " " + d.toLocaleTimeString("cs-CZ",{hour:"2-digit",minute:"2-digit"});
        const tkr = item.ticker || "‚Äî";
        const baseV = item.values?.base;
        const up = item.values?.upsidePct;

        const tr = document.createElement("tr");

        const tdDate = document.createElement("td");
        tdDate.textContent = date;

        const tdT = document.createElement("td");
        tdT.textContent = tkr;

        const tdBase = document.createElement("td");
        tdBase.textContent = fmtMoney(baseV);

        const tdUp = document.createElement("td");
        tdUp.innerHTML = `<span class="pct ${pctClass(up)}">${fmtPct(up)}</span>`;

        const tdAct = document.createElement("td");
        tdAct.style.textAlign = "right";

        const wrap = document.createElement("div");
        wrap.className = "rowActions";

        const openBtn = document.createElement("button");
        openBtn.className = "openBtn";
        openBtn.type = "button";
        openBtn.textContent = "Otev≈ô√≠t";
        openBtn.addEventListener("click", () => {
          showScreen("analyzer");
          $("#a_ticker").value = item.ticker || "";
          $("#a_price").value  = (item.price ?? "").toString().replace(".", ",");
          $("#a_fcfps").value  = (item.fcf0 ?? "").toString().replace(".", ",");
          $("#a_years").value  = (item.years ?? "").toString();

          $("#a_g").value  = (item.base?.g ?? "").toString().replace(".", ",");
          $("#a_r").value  = (item.base?.r ?? "").toString().replace(".", ",");
          $("#a_tg").value = (item.base?.tg ?? "").toString().replace(".", ",");

          $("#a_bear_g").value  = (item.adj?.bear?.g ?? "").toString().replace(".", ",");
          $("#a_bear_r").value  = (item.adj?.bear?.r ?? "").toString().replace(".", ",");
          $("#a_bear_tg").value = (item.adj?.bear?.tg ?? "").toString().replace(".", ",");

          $("#a_bull_g").value  = (item.adj?.bull?.g ?? "").toString().replace(".", ",");
          $("#a_bull_r").value  = (item.adj?.bull?.r ?? "").toString().replace(".", ",");
          $("#a_bull_tg").value = (item.adj?.bull?.tg ?? "").toString().replace(".", ",");

          setMsg("#calcMsg","Naƒçteno z Watchlistu. Klikni ‚ÄûSpoƒç√≠tat‚Äú.");
          $("#resultBox").style.display = "none";
        });

        const delBtn = document.createElement("button");
        delBtn.className = "trash";
        delBtn.type = "button";
        delBtn.textContent = "üóë";
        delBtn.title = "Smazat polo≈æku";
        delBtn.addEventListener("click", () => {
          const next = loadWatchlist().filter(x => x.id !== item.id);
          saveWatchlist(next);
          renderWatchlist();
        });

        wrap.appendChild(openBtn);
        wrap.appendChild(delBtn);
        tdAct.appendChild(wrap);

        tr.appendChild(tdDate);
        tr.appendChild(tdT);
        tr.appendChild(tdBase);
        tr.appendChild(tdUp);
        tr.appendChild(tdAct);

        body.appendChild(tr);
      }
    }

    $("#btnClearAll").addEventListener("click", () => {
      const ok = confirm("Opravdu smazat cel√Ω watchlist?");
      if(!ok) return;
      saveWatchlist([]);
      renderWatchlist();
      setMsg("#wlMsg","Watchlist smaz√°n.");
    });

    $("#btnExport").addEventListener("click", () => {
      const wl = loadWatchlist();
      if(wl.length === 0){
        setMsg("#wlMsg","Nen√≠ co exportovat.");
        return;
      }

      const sep = ";";
      const lines = [];
      lines.push(["datum","ticker","cena","fcf_na_akcii","roky","base_g","base_r","base_tg","bear","base","bull","upside_pct"].join(sep));

      const toCsvCell = (v) => {
        const s = (v==null) ? "" : String(v);
        if(/[;"\n]/.test(s)) return `"${s.replace(/"/g,'""')}"`;
        return s;
      };

      for(const item of wl){
        const d = new Date(item.ts);
        const date = d.toLocaleString("cs-CZ");
        const row = [
          date,
          item.ticker ?? "",
          item.price ?? "",
          item.fcf0 ?? "",
          item.years ?? "",
          item.base?.g ?? "",
          item.base?.r ?? "",
          item.base?.tg ?? "",
          item.values?.bear ?? "",
          item.values?.base ?? "",
          item.values?.bull ?? "",
          item.values?.upsidePct ?? ""
        ];
        lines.push(row.map(toCsvCell).join(sep));
      }

      const bom = "\uFEFF";
      const csv = bom + lines.join("\n");
      const ts = new Date().toISOString().slice(0,10);
      downloadTextFile(`watchlist_${ts}.csv`, csv, "text/csv;charset=utf-8");
      setMsg("#wlMsg","CSV export sta≈æen.");
    });

    // ===== Compound Interest Calculator =====
    function futureValueWithMonthly(P0, PMT, annualRate, years){
      const r = annualRate / 12;
      const n = Math.round(years * 12);
      if(n <= 0) return NaN;
      if(!Number.isFinite(r)) return NaN;

      if(Math.abs(r) < 1e-12){
        return P0 + PMT * n;
      }
      const f = Math.pow(1+r, n);
      return P0 * f + PMT * ( (f - 1) / r );
    }

    function requiredMonthlyForTarget(P0, target, annualRate, years){
      function requiredMonthlyForTarget(P0, target, annualRate, years){
  const r = annualRate / 12;
  const n = Math.round(years * 12);
  if(n <= 0) return NaN;
  if(!Number.isFinite(r)) return NaN;

  if(Math.abs(r) < 1e-12){
    return (target - P0) / n;
  }
  const f = Math.pow(1+r, n);
  const denom = (f - 1) / r;
  return (target - P0 * f) / denom;
}

$("#btnCalcCI").addEventListener("click", () => {
  setMsg("#ciMsg","");
  $("#ciResult").style.display = "none";

  const start   = parseNum($("#c_start").value) || 0;
  const monthly = parseNum($("#c_monthly").value) || 0;
  const ratePct = parseNum($("#c_rate").value);
  const years   = parseNum($("#c_years").value);

  if(!(years > 0)){
    setMsg("#ciMsg","Dopl≈à dobu v letech (nap≈ô. 15).");
    return;
  }
  if(!Number.isFinite(ratePct)){
    setMsg("#ciMsg","Dopl≈à roƒçn√≠ zhodnocen√≠ (nap≈ô. 7).");
    return;
  }

  const annualRate = ratePct / 100;
  const fv = futureValueWithMonthly(start, monthly, annualRate, years);
  const months = Math.round(years * 12);
  const contrib = start + monthly * months;
  const gain = Number.isFinite(fv) ? (fv - contrib) : NaN;

  const target = parseNum($("#c_target").value);
  let needMonthly = NaN;
  if(Number.isFinite(target) && target > 0){
    needMonthly = requiredMonthlyForTarget(start, target, annualRate, years);
  }

  const body = $("#ciBody");
  body.innerHTML = "";

  const addRow = (k,v) => {
    const tr = document.createElement("tr");
    tr.innerHTML =
      `<td style="font-weight:900">${k}</td>
       <td style="text-align:right; font-weight:900">${v}</td>`;
    body.appendChild(tr);
  };

  addRow("Budouc√≠ hodnota", fmtMoney(fv));
  addRow("Celkem vlo≈æeno", fmtMoney(contrib));
  addRow("Zhodnocen√≠", fmtMoney(gain));

  if(Number.isFinite(target) && target > 0){
    addRow("C√≠lov√° ƒç√°stka", fmtMoney(target));
    addRow(
      "Pot≈ôebn√Ω mƒõs√≠ƒçn√≠ vklad",
      Number.isFinite(needMonthly) ? fmtMoney(Math.max(0, needMonthly)) : "‚Äî"
    );
  }

  $("#ciKpi").textContent =
    `Roky: ${years} ‚Ä¢ Roƒçn√≠ v√Ωnos: ${ratePct.toLocaleString("cs-CZ")} %`;

  $("#ciResult").style.display = "block";
  setMsg("#ciMsg","Hotovo. V√Ωsledek je n√≠≈æe.");
});

$("#btnResetCI").addEventListener("click", () => {
  [
    "#c_start",
    "#c_monthly",
    "#c_rate",
    "#c_years",
    "#c_target",
    "#c_note"
  ].forEach(id => $(id).value = "");

  $("#ciResult").style.display = "none";
  setMsg("#ciMsg","");
});

// ===== START APP =====
showScreen("home");   






    

          
    

    

    
    


    





    

    

  
        

    
    

  

  





