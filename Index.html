<!DOCTYPE html>
<html lang="cs">
<head>
  <meta charset="UTF-8" />
  <title>Equity Analyzer</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <style>
    :root {
      --bg-main: #0b0216;
      --bg-card: #241047;
      --bg-card-soft: #2f145c;
      --bg-chip: #3a1a6e;
      --accent: #b58cff;
      --accent-soft: #d2baff;
      --text-main: #ffffff;
      --text-muted: #b5a4e0;
      --danger: #ff7b9c;
      --success: #7CFC9A;
    }

    * {
      box-sizing: border-box;
    }

    body {
      margin: 0;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI",
        sans-serif;
      background: radial-gradient(circle at top, #29105a 0, #0b0216 55%);
      color: var(--text-main);
    }

    .app {
      min-height: 100vh;
      max-width: 520px;
      margin: 0 auto;
      padding: 20px 16px 32px;
    }

    /* Hero */

    .hero {
      background: linear-gradient(135deg, #321268, #19082f);
      border-radius: 26px;
      padding: 20px 20px 22px;
      box-shadow: 0 18px 40px rgba(0, 0, 0, 0.7);
      margin-bottom: 20px;
    }

    .hero-title {
      font-size: 1.5rem;
      letter-spacing: 0.18em;
      text-transform: uppercase;
      margin: 0 0 10px;
    }

    .hero-sub {
      margin: 0;
      font-size: 0.95rem;
      color: var(--text-muted);
    }

    /* Drawer list ‚Äì hlavn√≠ ≈°upl√≠ky */

    .drawer-list {
      display: flex;
      flex-direction: column;
      gap: 14px;
      margin-top: 10px;
    }

    .drawer {
      background: var(--bg-card);
      border-radius: 22px;
      padding: 14px 16px;
      box-shadow: 0 14px 30px rgba(0, 0, 0, 0.75);
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 10px;
      cursor: pointer;
      transition: transform 0.12s ease, box-shadow 0.12s ease,
        background 0.12s ease;
    }

    .drawer:hover {
      transform: translateY(-1px);
      background: var(--bg-card-soft);
      box-shadow: 0 18px 38px rgba(0, 0, 0, 0.85);
    }

    .drawer-left {
      display: flex;
      flex-direction: column;
      gap: 4px;
    }

    .drawer-label {
      font-size: 0.75rem;
      text-transform: uppercase;
      letter-spacing: 0.16em;
      color: var(--text-muted);
    }

    .drawer-title {
      font-size: 1.05rem;
    }

    .drawer-desc {
      font-size: 0.85rem;
      color: var(--text-muted);
    }

    .drawer-chevron {
      width: 32px;
      height: 32px;
      border-radius: 999px;
      background: var(--bg-chip);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 1.1rem;
    }

    /* Obecn√Ω layout obrazovek */

    .screen {
      display: none;
      min-height: 100vh;
      max-width: 520px;
      margin: 0 auto;
      padding: 20px 16px 32px;
      background: var(--bg-main);
    }

    .screen.active {
      display: block;
    }

    .page-header {
      display: flex;
      align-items: center;
      gap: 10px;
      margin-bottom: 14px;
    }

    .btn-back {
      border: none;
      background: var(--bg-card);
      color: var(--text-main);
      border-radius: 999px;
      padding: 6px 14px;
      font-size: 0.9rem;
      display: inline-flex;
      align-items: center;
      gap: 6px;
      cursor: pointer;
    }

    .page-title {
      font-size: 1.2rem;
      margin: 0;
    }

    .page-sub {
      margin: 4px 0 14px;
      font-size: 0.9rem;
      color: var(--text-muted);
    }

    .page-card {
      background: var(--bg-card);
      border-radius: 22px;
      padding: 14px 16px;
      box-shadow: 0 12px 30px rgba(0, 0, 0, 0.75);
      margin-bottom: 16px;
    }

    /* Form prvky */

    .field-label {
      font-size: 0.8rem;
      display: block;
      margin-bottom: 4px;
      color: var(--text-muted);
    }

    .field-input,
    .field-select,
    .field-textarea {
      width: 100%;
      padding: 10px 12px;
      border-radius: 14px;
      border: 1px solid rgba(255, 255, 255, 0.14);
      background: #14062e;
      color: var(--text-main);
      font-size: 0.95rem;
      outline: none;
    }

    .field-input:focus,
    .field-select:focus,
    .field-textarea:focus {
      border-color: var(--accent-soft);
      box-shadow: 0 0 0 1px rgba(181, 140, 255, 0.45);
    }

    .field-textarea {
      resize: vertical;
      min-height: 180px;
      max-height: 420px;
    }

    .btn-primary {
      border: none;
      background: var(--accent);
      color: #120624;
      border-radius: 999px;
      padding: 10px 20px;
      font-size: 0.95rem;
      font-weight: 600;
      cursor: pointer;
      box-shadow: 0 10px 24px rgba(0, 0, 0, 0.75);
    }

    .btn-primary:active {
      transform: translateY(1px);
      box-shadow: 0 6px 16px rgba(0, 0, 0, 0.8);
    }

    .btn-secondary {
      border: none;
      background: var(--bg-chip);
      color: var(--accent-soft);
      border-radius: 999px;
      padding: 8px 16px;
      font-size: 0.85rem;
      cursor: pointer;
    }

    .btn-inline {
      display: inline-flex;
      align-items: center;
      gap: 6px;
    }

    /* Portfolio tabulka */

    .table-wrapper {
      width: 100%;
      overflow-x: auto;
    }

    table {
      width: 100%;
      border-collapse: collapse;
      font-size: 0.82rem;
    }

    th,
    td {
      padding: 6px 8px;
      text-align: left;
      white-space: nowrap;
    }

    th {
      font-weight: 600;
      color: var(--accent-soft);
      border-bottom: 1px solid rgba(255, 255, 255, 0.15);
    }

    tr:nth-child(even) td {
      background: rgba(255, 255, 255, 0.02);
    }

    .pill {
      padding: 2px 8px;
      border-radius: 999px;
      background: var(--bg-chip);
      font-size: 0.72rem;
    }

    .gain {
      color: var(--success);
    }

    .loss {
      color: var(--danger);
    }

    .cell-actions {
      text-align: right;
    }

    .btn-delete {
      border: none;
      background: transparent;
      color: rgba(255, 255, 255, 0.7);
      cursor: pointer;
      font-size: 1rem;
    }

    /* Mal√© info texty */

    .hint {
      font-size: 0.78rem;
      color: var(--text-muted);
      margin-top: 6px;
    }

    .status {
      font-size: 0.8rem;
      margin-top: 6px;
      color: var(--accent-soft);
    }

    @media (max-width: 360px) {
      .hero-title {
        font-size: 1.35rem;
      }

      .drawer-title {
        font-size: 1rem;
      }
    }
  </style>
</head>

<body>
  <!-- DOMOVSK√Å OBRAZOVKA -->
  <main id="screen-home" class="app screen active">
    <section class="hero">
      <h1 class="hero-title">Equity Analyzer</h1>
      <p class="hero-sub">Apka na anal√Ωzu akci√≠.</p>
    </section>

    <div class="drawer-list">
      <!-- 1) Rychl√Ω v√Ωpoƒçet ‚Äì zat√≠m jen placeholder -->
      <article class="drawer" data-open="analysis">
        <div class="drawer-left">
          <div class="drawer-label">Anal√Ωza</div>
          <h2 class="drawer-title">Rychl√Ω v√Ωpoƒçet hodnoty</h2>
          <p class="drawer-desc">Jednoduch√Ω odhad f√©rov√© ceny (p≈ôipravujeme).</p>
        </div>
        <div class="drawer-chevron">‚Üí</div>
      </article>

      <!-- 2) Moje portfolio -->
      <article class="drawer" data-open="portfolio">
        <div class="drawer-left">
          <div class="drawer-label">Portfolia</div>
          <h2 class="drawer-title">Moje portfolio</h2>
          <p class="drawer-desc">
            Akcie, ETF i krypto na jednom m√≠stƒõ.
          </p>
        </div>
        <div class="drawer-chevron">‚Üí</div>
      </article>

      <!-- 3) Moje pozn√°mky -->
      <article class="drawer" data-open="notes">
        <div class="drawer-left">
          <div class="drawer-label">Pozn√°mky</div>
          <h2 class="drawer-title">Moje z√°pisky</h2>
          <p class="drawer-desc">Textov√Ω se≈°it k anal√Ωz√°m a n√°pad≈Øm.</p>
        </div>
        <div class="drawer-chevron">‚Üí</div>
      </article>
    </div>
  </main>

  <!-- =============== 1) ANAL√ùZA ‚Äì placeholder ================= -->
  <section id="screen-analysis" class="screen">
    <div class="page-header">
      <button class="btn-back" data-back="home">‚Üê Zpƒõt</button>
      <h2 class="page-title">Rychl√Ω v√Ωpoƒçet hodnoty</h2>
    </div>
    <p class="page-sub">
      Tady pozdƒõji p≈ôid√°me rychl√Ω v√Ωpoƒçet f√©rov√© ceny podle vlastn√≠ch
      sc√©n√°≈ô≈Ø a DCF modelu.
    </p>

    <div class="page-card">
      <p class="hint">
        Zat√≠m jen informativn√≠ obrazovka ‚Äì funkci dopln√≠me, a≈æ bude≈°
        cht√≠t ≈ôe≈°it konkr√©tn√≠ logiku v√Ωpoƒçtu.
      </p>
    </div>
  </section>

  <!-- =============== 2) MOJE PORTFOLIO ================= -->
  <section id="screen-portfolio" class="screen">
    <div class="page-header">
      <button class="btn-back" data-back="home">‚Üê Zpƒõt</button>
      <h2 class="page-title">Moje portfolio</h2>
    </div>

    <p class="page-sub">
      Jednoduch√Ω p≈ôehled akci√≠, ETF a krypta. Zapisuje≈° ruƒçnƒõ, v√Ωpoƒçet
      procenta zisku/ztr√°ty je automatick√Ω.
    </p>

    <!-- Formul√°≈ô pro p≈ôid√°n√≠ polo≈æky -->
    <div class="page-card">
      <div style="display: flex; flex-direction: column; gap: 10px;">
        <div style="display: flex; gap: 8px;">
          <div style="flex: 0 0 38%;">
            <label for="pf-type" class="field-label">Typ</label>
            <select id="pf-type" class="field-select">
              <option value="Akcie">Akcie</option>
              <option value="ETF">ETF</option>
              <option value="Krypto">Krypto</option>
              <option value="Jin√©">Jin√©</option>
            </select>
          </div>
          <div style="flex: 0 0 28%;">
            <label for="pf-ticker" class="field-label">Ticker</label>
            <input id="pf-ticker" class="field-input" placeholder="nap≈ô. PLTR" />
          </div>
          <div style="flex: 1;">
            <label for="pf-name" class="field-label">N√°zev</label>
            <input
              id="pf-name"
              class="field-input"
              placeholder="Palantir Technologies"
            />
          </div>
        </div>

        <div style="display: flex; gap: 8px;">
          <div style="flex: 1;">
            <label for="pf-buy" class="field-label">N√°kupn√≠ cena</label>
            <input
              id="pf-buy"
              class="field-input"
              type="number"
              step="0.01"
              placeholder="nap≈ô. 18.50"
            />
          </div>
          <div style="flex: 1;">
            <label for="pf-current" class="field-label">Aktu√°ln√≠ cena</label>
            <input
              id="pf-current"
              class="field-input"
              type="number"
              step="0.01"
              placeholder="nap≈ô. 21.30"
            />
          </div>
        </div>

        <div style="display:flex; justify-content: space-between; align-items:center; gap:8px; margin-top:4px;">
          <button id="pf-add" class="btn-primary btn-inline">
            + P≈ôidat do portfolia
          </button>
          <button id="pf-clear" class="btn-secondary btn-inline">
            Vymazat cel√© portfolio
          </button>
        </div>

        <p class="hint">
          Quantitu teƒè ne≈ôe≈°√≠me ‚Äì jde ƒçistƒõ o srovn√°n√≠ n√°kupn√≠ a aktu√°ln√≠
          ceny pro ka≈ædou pozici.
        </p>
      </div>
    </div>

    <!-- Tabulka portfolia -->
    <div class="page-card">
      <div class="table-wrapper">
        <table id="pf-table">
          <thead>
            <tr>
              <th>Typ</th>
              <th>Ticker</th>
              <th>N√°zev</th>
              <th>N√°kup</th>
              <th>Aktu√°ln√≠</th>
              <th>Zmƒõna %</th>
              <th class="cell-actions"></th>
            </tr>
          </thead>
          <tbody></tbody>
        </table>
      </div>
      <p class="hint">
        Data se ukl√°daj√≠ lok√°lnƒõ v prohl√≠≈æeƒçi (localStorage). Nikam
        se nepos√≠laj√≠.
      </p>
    </div>
  </section>

  <!-- =============== 3) MOJE POZN√ÅMKY ================= -->
  <section id="screen-notes" class="screen">
    <div class="page-header">
      <button class="btn-back" data-back="home">‚Üê Zpƒõt</button>
      <h2 class="page-title">Moje z√°pisky</h2>
    </div>

    <p class="page-sub">
      Jednoduch√Ω textov√Ω se≈°it ‚Äì pozn√°mky k firm√°m, n√°pady, sc√©n√°≈ôe,
      todo list.
    </p>

    <div class="page-card">
      <label for="notes-area" class="field-label">Text pozn√°mek</label>
      <textarea
        id="notes-area"
        class="field-textarea"
        placeholder="Sem si m≈Ø≈æe≈° ps√°t √∫plnƒõ cokoliv‚Ä¶"
      ></textarea>

      <div style="margin-top: 10px; display:flex; justify-content: space-between; align-items:center; gap:8px;">
        <button id="notes-save" class="btn-primary btn-inline">
          üíæ Ulo≈æit pozn√°mky
        </button>
        <button id="notes-clear" class="btn-secondary btn-inline">
          Vymazat text
        </button>
      </div>

      <p id="notes-status" class="status"></p>
      <p class="hint">
        Pozn√°mky se ukl√°daj√≠ jen k tobƒõ do prohl√≠≈æeƒçe (localStorage).
      </p>
    </div>
  </section>

  <!-- =============== SCRIPT ‚Äì navigace + logika =============== -->
  <script>
    (function () {
      /* --- jednoduch√° navigace mezi obrazovkami --- */
      function showScreen(name) {
        var id = name.startsWith("screen-") ? name : "screen-" + name;
        document.querySelectorAll(".screen").forEach(function (el) {
          el.classList.remove("active");
        });
        var target = document.getElementById(id);
        if (target) target.classList.add("active");
      }

      document
        .querySelectorAll("[data-open]")
        .forEach(function (drawer) {
          drawer.addEventListener("click", function () {
            var target = drawer.getAttribute("data-open");
            showScreen(target);
          });
        });

      document.querySelectorAll(".btn-back").forEach(function (btn) {
        btn.addEventListener("click", function () {
          var back = btn.getAttribute("data-back") || "home";
          showScreen(back);
        });
      });

      /* --- Pozn√°mky --- */
      var notesKey = "ea-notes-text";
      var notesArea = document.getElementById("notes-area");
      var notesStatus = document.getElementById("notes-status");
      var notesSave = document.getElementById("notes-save");
      var notesClear = document.getElementById("notes-clear");

      function setNotesStatus(text) {
        if (!notesStatus) return;
        notesStatus.textContent = text || "";
        if (text) {
          setTimeout(function () {
            notesStatus.textContent = "";
          }, 2000);
        }
      }

      if (notesArea) {
        try {
          var saved = localStorage.getItem(notesKey);
          if (saved) notesArea.value = saved;
        } catch (e) {
          console.error("Chyba p≈ôi naƒç√≠t√°n√≠ pozn√°mek", e);
        }
      }

      if (notesSave && notesArea) {
        notesSave.addEventListener("click", function () {
          try {
            localStorage.setItem(notesKey, notesArea.value || "");
            setNotesStatus("Pozn√°mky ulo≈æen√©.");
          } catch (e) {
            console.error("Chyba p≈ôi ukl√°d√°n√≠ pozn√°mek", e);
            setNotesStatus("Nepoda≈ôilo se ulo≈æit.");
          }
        });
      }

      if (notesClear && notesArea) {
        notesClear.addEventListener("click", function () {
          notesArea.value = "";
          try {
            localStorage.removeItem(notesKey);
          } catch (e) {}
          setNotesStatus("Text byl vymaz√°n.");
        });
      }

      /* --- Portfolio --- */
      var pfKey = "ea-portfolio";
      var pfType = document.getElementById("pf-type");
      var pfTicker = document.getElementById("pf-ticker");
      var pfName = document.getElementById("pf-name");
      var pfBuy = document.getElementById("pf-buy");
      var pfCurrent = document.getElementById("pf-current");
      var pfAdd = document.getElementById("pf-add");
      var pfClear = document.getElementById("pf-clear");
      var pfTableBody = document.querySelector("#pf-table tbody");

      function loadPortfolio() {
        try {
          var raw = localStorage.getItem(pfKey);
          if (!raw) return [];
          var parsed = JSON.parse(raw);
          return Array.isArray(parsed) ? parsed : [];
        } catch (e) {
          console.error("Chyba p≈ôi naƒç√≠t√°n√≠ portfolia", e);
          return [];
        }
      }

      function savePortfolio(list) {
        try {
          localStorage.setItem(pfKey, JSON.stringify(list || []));
        } catch (e) {
          console.error("Chyba p≈ôi ukl√°d√°n√≠ portfolia", e);
        }
      }

      function formatNumber(value) {
        if (!isFinite(value)) return "";
        return value.toLocaleString("cs-CZ", {
          minimumFractionDigits: 2,
          maximumFractionDigits: 2,
        });
      }

      function renderPortfolio() {
        if (!pfTableBody) return;
        var list = loadPortfolio();
        pfTableBody.innerHTML = "";
        list.forEach(function (item, index) {
          var tr = document.createElement("tr");

          var diff =
            item.buy > 0
              ? ((item.current - item.buy) / item.buy) * 100
              : 0;
          var diffText =
            (diff >= 0 ? "+" : "") + diff.toFixed(2).toString() + " %";
          var diffClass = diff >= 0 ? "gain" : "loss";

          tr.innerHTML =
            "<td><span class='pill'>" +
            (item.type || "") +
            "</span></td>" +
            "<td>" +
            (item.ticker || "") +
            "</td>" +
            "<td>" +
            (item.name || "") +
            "</td>" +
            "<td>" +
            formatNumber(item.buy) +
            "</td>" +
            "<td>" +
            formatNumber(item.current) +
            "</td>" +
            "<td class='" +
            diffClass +
            "'>" +
            diffText +
            "</td>" +
            "<td class='cell-actions'><button class='btn-delete' data-index='" +
            index +
            "' title='Smazat ≈ô√°dek'>√ó</button></td>";

          pfTableBody.appendChild(tr);
        });
      }

      function clearForm() {
        if (pfTicker) pfTicker.value = "";
        if (pfName) pfName.value = "";
        if (pfBuy) pfBuy.value = "";
        if (pfCurrent) pfCurrent.value = "";
      }

      if (pfAdd) {
        pfAdd.addEventListener("click", function () {
          var type = pfType ? pfType.value.trim() : "";
          var ticker = pfTicker ? pfTicker.value.trim().toUpperCase() : "";
          var name = pfName ? pfName.value.trim() : "";
          var buy = pfBuy ? parseFloat(pfBuy.value.replace(",", ".")) : NaN;
          var current = pfCurrent
            ? parseFloat(pfCurrent.value.replace(",", "."))
            : NaN;

          if (!ticker || !name || !isFinite(buy) || !isFinite(current)) {
            alert(
              "Vypl≈à pros√≠m typ, ticker, n√°zev, n√°kupn√≠ a aktu√°ln√≠ cenu."
            );
            return;
          }

          var list = loadPortfolio();
          list.push({
            type: type || "Akcie",
            ticker: ticker,
            name: name,
            buy: buy,
            current: current,
          });
          savePortfolio(list);
          renderPortfolio();
          clearForm();
        });
      }

      if (pfClear) {
        pfClear.addEventListener("click", function () {
          if (
            confirm(
              "Opravdu chce≈° vymazat cel√© portfolio? Tuto akci nelze vr√°tit."
            )
          ) {
            savePortfolio([]);
            renderPortfolio();
          }
        });
      }

      if (pfTableBody) {
        pfTableBody.addEventListener("click", function (e) {
          var btn = e.target.closest(".btn-delete");
          if (!btn) return;
          var index = Number(btn.getAttribute("data-index"));
          var list = loadPortfolio();
          if (!isNaN(index) && index >= 0 && index < list.length) {
            list.splice(index, 1);
            savePor
